module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=16)}([,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=p(n(17)),o=p(n(18)),u=p(n(21)),i=n(19),s=p(n(22)),f=p(n(20)),c=p(n(23)),l=p(n(24)),d=p(n(25)),g=p(n(26)),h=p(n(27));function p(e){return e&&e.__esModule?e:{default:e}}var v,y,_,S,O=(v={},_={onAppLaunch:(y={onAppLaunch:function(e){s.default.getData(e),a.default.isRuningMiniPro()&&(this.XH_STATISTIC=O)},onAppShow:function(e){console.log("appShow options: ",e),s.default.getData(e).then(function(){h.default.send("login_in"),d.default.start()})},onAppHide:function(e){s.default.getDataSync(function(){h.default.sendSync("login_out")}),d.default.stop()},onShareAppMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return g.default.onApp(e,t)},onPageShow:function(){},onGameShow:function(e){v.onGameShow?wx.onShow(function(t){e&&e(t)}):(v.onGameShow=!0,wx.onShow(function(t){console.log("appShow options: ",t),s.default.getData(t).then(function(){h.default.sendSync("login_in"),d.default.start()}),e&&e(t)}))},onGameHide:function(e){v.onGameHide?wx.onHide(function(t){e&&e(t)}):(v.onGameHide=!0,wx.onHide(function(t){s.default.getDataSync(function(){return h.default.sendSync("login_out")}),d.default.stop(),e&&e(t)}))},shareGameMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};g.default.emitGame(e)},onShareGameMessage:function(e){return g.default.onGame(e)}}).onAppLaunch,onAppShow:y.onAppShow,onAppHide:y.onAppHide,onShareAppMessage:y.onShareAppMessage,onPageShow:y.onPageShow},S={onShow:y.onGameShow,onHide:y.onGameHide,shareAppMessage:y.shareGameMessage,onShareAppMessage:y.onShareGameMessage},new(function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a.default.isRuningMiniPro()&&(a.default.addPreHook("App",{onLaunch:_.onAppLaunch,onShow:_.onAppShow,onHide:_.onAppHide}),a.default.addPreHook("Page",{onShareAppMessage:_.onShareAppMessage,onShow:_.onPageShow})),a.default.isRuningMiniGame()){if(GameGlobal.XH_STATISTIC)return void console.error("数据SDK禁止再次初始化，请排查是否有引入多份的数据SDK");for(var t in GameGlobal.XH_STATISTIC=this,S)this[t]=S[t],"shareAppMessage"!==t&&S[t]();s.default.getDataSync(function(){l.default.send("appLoaded")})}}return r(e,[{key:"sendLoadingLog",value:function(e){s.default.getDataSync(function(){l.default.send(e)})}},{key:"sendTigerBehaviourSync",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c.default.send(e,t)}},{key:"packLogData",value:function(e,t){return f.default.packLogData(e,t)}},{key:"sendHeartBeatRecord",value:function(){return d.default.start()}},{key:"getSDKConfig",value:function(){return a.default.deepClone(i.SDK_CONFIG)}},{key:"sendUserInfo",value:function(e){e&&(u.default.set("userInfo",e),e.open_id&&u.default.set("xhstat_uuid",e.open_id))}},{key:"switchRequestLog",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).open;void 0!==e&&(o.default.REQUEST_LOG=e)}},{key:"sendLog",value:function(e,t){return h.default.sendSync(e,t)}},{key:"sendEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return/(^(\d|[a-zA-Z])+$)/.test(e)?h.default.sendSync(e,t):console.error("事件名称只能包含英文和数字")}}]),e}()));e.exports=O},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var a=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"addPreHook",value:function(e,t){var n=["onShareAppMessage"],r=null;"App"===e&&(r=App),"Page"===e&&(r=Page);var a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=function(r){var a=t[r]||function(){};if(e[r]){var o=e[r];e[r]=function(){for(var e=this,t=arguments.length,u=Array(t),i=0;i<t;i++)u[i]=arguments[i];if(n.indexOf(r)>-1){var s=o.apply(this,u);return a.call.apply(a,[this,s].concat(u))}var f=a.apply(this,u);f&&f.then?f.then(function(){return o.apply(e,u)}).catch(function(){}):o.apply(this,u)}}else e[r]=a};for(var o in t)a(o);r(e)};"App"===e&&(App=a),"Page"===e&&(Page=a)}},{key:"normalizeRes",value:function(e){return e.errMsg||e.statusCode?e.data?{err:e.data.err||0,code:e.statusCode,message:e.data.msg,data:e.data.data}:{err:1,code:e.statusCode||999,message:e.errMsg}:{err:e.err,code:e.statusCode,message:"string"==typeof e?e:e.msg,data:e.data}}},{key:"promiseFy",value:function(e,t){var n=this,r={};if(t)for(var a in t)r[a]=t[a];return new Promise(function(t,a){r.success=function(e){(200===e.statusCode||e.errMsg.indexOf(":ok")>-1)&&t(e)},r.fail=function(e){a(n.normalizeRes(e))},e?e.call(wx,r):a({message:"miniProgramFn is not defined"})})}},{key:"addQuery",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.stringifyQuery(t);return n?e.indexOf("?")>-1?e+"&"+n:e+"?"+n:e}},{key:"stringifyQuery",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];for(var n in e){var r=e[n];r="string"==typeof r?r:"number"==typeof r&&isNaN(r)?"NaN":void 0===r?"undefined":JSON.stringify(r),t.push([n+"="+r])}return t.join("&")}},{key:"getCurrentRoute",value:function(){var e=getCurrentPages();return e[e.length-1]?"/"+e[e.length-1].route:"pages/index/index"}},{key:"getCurrentOptions",value:function(){var e=getCurrentPages();return e[e.length-1]?e[e.length-1].options:{}}},{key:"getCurrentFullUrl",value:function(){var e=this.getCurrentRoute(),t=this.getCurrentOptions();return this.addQuery(e,t)}},{key:"getNetWorkStatus",value:function(){var e=this;return this.getNetWorkStatusPromise||(this.getNetWorkStatusPromise=this.promiseFy(wx.getNetworkType),wx.onNetworkStatusChange(function(t){e.currNetWorkType=t.networkType})),Promise.resolve().then(function(){return e.getNetWorkStatusPromise}).then(function(t){return e.currNetWorkType?e.currNetWorkType:t.networkType}).catch(function(e){return{}})}},{key:"getSystemInfo",value:function(){return this.promiseFy(wx.getSystemInfo).catch(function(e){return{errMsg:e}})}},{key:"getLocationInfo",value:function(){return this.promiseFy(wx.getLocation,{type:"wgs84"}).catch(function(e){return{}})}},{key:"setStorage",value:function(e,t){return this.promiseFy(wx.setStorage,{key:e,data:t}).then(function(){return t}).catch(function(){})}},{key:"getStorage",value:function(e){return this.promiseFy(wx.getStorage,{key:e}).then(function(e){return e.data}).catch(function(){return""})}},{key:"getStorageSync",value:function(e){try{return wx.getStorageSync(e)}catch(e){return""}}},{key:"setStorageSync",value:function(e,t){try{wx.setStorageSync(e,t)}catch(e){console.error("setStorageSync error: ",e)}}},{key:"isRuningMiniPro",value:function(){return"function"==typeof getApp&&"undefined"==typeof GameGlobal&&"undefined"!=typeof wx}},{key:"isRuningMiniGame",value:function(){return"function"!=typeof getApp&&"undefined"!=typeof GameGlobal&&"undefined"!=typeof wx}},{key:"isEmptyObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"{}"===JSON.stringify(e)}},{key:"getVariableType",value:function(e){return Number.isNaN(e)?NaN:Object.prototype.toString.call(e).slice(8,-1)}},{key:"deepClone",value:function(e){var t=this.getVariableType(e),n=void 0;if("Object"===t&&(n={}),"Array"===t&&(n=[]),!n)return e;for(var r in e){var a=e[r],o=this.getVariableType(a),u="Object"===o||"Array"===o;n[r]=u?this.deepClone(a):a}return n}},{key:"filterEmptyKey",value:function(e){if("Object"===this.getVariableType(e))for(var t in e)"Object"===this.getVariableType(e[t])&&(e[t]=this.filterEmptyKey(e[t])),(null===e[t]||void 0===e[t]||""===e[t]||this.isEmptyObject(e[t]))&&delete e[t];return e}}]),e}());t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),a=u(n(17)),o=u(n(20));function u(e){return e&&e.__esModule?e:{default:e}}var i=function(){var e={test:"https://h5game-log.kuaiyugo.com",prod:"https://h5game-log.kuaiyugo.com"},t={tigerBehaviour:function(){return e[r.SDK_CONFIG.ENV]+"/api/tiger/v1/collect_user_behaviour"},heartBeatRecordUrl:function(){return e[r.SDK_CONFIG.ENV]+"/ping"},loadingLog:function(){return e[r.SDK_CONFIG.ENV]+"/dataAnalysis/saveLoadingLog"},behaviorLog:function(){return e[r.SDK_CONFIG.ENV]+"/dataAnalysis/saveUserBehaviorLogV2"}},n={postLoadingLog:{method:"POST",urlMaker:function(e){return t.loadingLog()},dataMaker:function(e){return e}},postTigerBehaviour:{method:"POST",urlMaker:function(e){return t.tigerBehaviour()},dataMaker:function(e){return e}},postHeartBeatRecord:{method:"POST",urlMaker:function(){return t.heartBeatRecordUrl()},dataMaker:function(e){var t=e.uid,n=e.uidfp;return{aid:r.SDK_CONFIG.APPID,uidfp:n,uid:t}},noLog:!0},postBehaviorLog:{method:"POST",urlMaker:function(e){return t.behaviorLog()},dataMaker:function(e){return e}}};function u(e){e.apiName;var t=e.urlMaker,n=e.dataMaker,r=e.method,u=void 0===r?"GET":r,f=e.noLog,c=void 0!==f&&f,l=e.headerMaker;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Promise.resolve().then(function(){return o.default.networkRelink()}).then(function(){return a.default.promiseFy(wx.request,{url:t(e),method:u,data:n&&n(e),header:l?l(e):s()})}).then(function(r){var o=a.default.normalizeRes(r);try{!c&&i.REQUEST_LOG&&(console.warn("发起请求:"+u+t(e)),console.warn("请求Header: "+JSON.stringify(l?l(e):s())),console.warn("请求body: "+JSON.stringify(n&&n(e))),console.warn("请求response: ",r),console.warn("返回: ",o))}catch(e){console.error("请求日志打印时报错"+e)}return 200===o.code?Promise.resolve(o.data):Promise.reject(o)}).catch(function(r){var o=a.default.normalizeRes(r);try{console.warn("发起请求:"+u+t(e)),console.warn("请求Header: "+JSON.stringify(l?l(e):s())),console.warn("请求body: "+JSON.stringify(n&&n(e))),console.warn("请求response: ",r),console.warn("返回: ",o)}catch(e){console.error("请求日志打印时报错"+e)}return Promise.reject(o)})}}function s(){return{"content-type":"application/json"}}return new function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(){for(var e in n){var r=n[e];r.apiName=e,this[e]=u(r)}for(var a in t)this.API_LIST=this.API_LIST||{},this.API_LIST[a]=t[a],this.REQUEST_LOG=!0}.call(this)}}();t.default=i},function(e,t,n){"use strict";t.SDK_CONFIG={ENV:"prod",APPKEY:"52beba30-bd98-11e8-aab0-294230b0d9e6",APPID:"wx5401ab8855d01c48",PROGRAM_ID:"52beba31bd9811e8aab0294230b0d9e6",PROGRAM_SECRET:"52beba32bd9811e8aab0294230b0d9e6",SDKVERSION:"1.4.2",SHOULD_GET_LOCATION:false,JUMP_MINI_PROGRAM_ENV:"release"},t.HEART_BEAT_TIME_GAP=5e3,t.STORAGE_KEYS={USER_TID_STORAGE_KEY:"XH_USER_TID"},t.RESPONSE={NO_AVAILABLE_HOST:{message:"NO_AVAILABLE_HOST"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(19),o=i(n(21)),u=i(n(17));function i(e){return e&&e.__esModule?e:{default:e}}var s=null;t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.API_RETRY_NETWORK_STATUS="none"}return r(e,[{key:"packLogData",value:function(e,t){var n=o.default.get("xhstat_sysInfo"),r=n.system,i=n.brand,s=n.version,f=n.model,c=n.platform,l=n.SDKVersion,d=e&&["cancel","404","render","click","confirm","login","qrcodeLogin","qrcodeRender"].indexOf(e)>-1?{system:r,brand:i,version:s,model:f,platform:c,SDKVersion:l}:o.default.get("xhstat_sysInfo"),g={n:"statistic_sdk",v:a.SDK_CONFIG.SDKVERSION,device:d};a.SDK_CONFIG.SHOULD_GET_LOCATION&&(g.location=o.default.get("xhstat_Location"));var h={ak:a.SDK_CONFIG.APPKEY,aid:a.SDK_CONFIG.APPID,type:e,tid:o.default.get("xhstat_tid"),uid:o.default.get("xhstat_uuid"),pid:o.default.get("userInfo")&&o.default.get("userInfo").pid,uidfp:o.default.get("userInfo")&&o.default.get("userInfo").ofp};return-1===["t1","t2","t3"].indexOf(e)&&(h=Object.assign(h,{ccode:o.default.get("xhstat_channelCode"),path:u.default.isRuningMiniPro()?u.default.getCurrentFullUrl():"",sid:o.default.get("xhstat_shareId"),sid2:o.default.get("xhstat_shareId2"),scene:o.default.get("xhstat_options_scene"),seid:o.default.get("seid")})),t&&Object.assign(h,t),g.ext=u.default.filterEmptyKey(h),{userLog:g}}},{key:"networkRelink",value:function(){var e=this;return s||(s=new Promise(function(t,n){u.default.getNetWorkStatus().then(function(n){"none"!=n?t():wx.onNetworkStatusChange(function(n){n.isConnected&&"none"==e.API_RETRY_NETWORK_STATUS&&t(),e.API_RETRY_NETWORK_STATUS=n.networkType})}).catch(function(e){return{}})})),s}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(17),u=(r=o)&&r.__esModule?r:{default:r};var i=function(){var e={xhstat_options:"",xhstat_nwt:"",xhstat_sysInfo:"",xhstat_shareId:"",xhstat_shareId2:"",xhstat_channelCode:"",xhstat_page_path:"",xhstat_tid:"",xhstat_uuid:"",xhstat_sessionId:""};function t(n,r){if("String"===u.default.getVariableType(n))return t(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},n,r));e=Object.assign({},e,n)}return new(function(){function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)}return a(n,[{key:"set",value:function(){return t.apply(void 0,arguments)}},{key:"get",value:function(){return function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(n){var a=n.split(".");if(a.length>1){var o=r[a[0]];return void 0!==o?t(a.slice(1).join("."),o):void 0}return u.default.deepClone(r[n])}return u.default.deepClone(r)}.apply(void 0,arguments)}}]),n}())}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=i(n(17)),o=(i(n(18)),i(n(21))),u=n(19);function i(e){return e&&e.__esModule?e:{default:e}}var s=null;t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getDataSync",value:function(e){var t=this,n=o.default.get("xhstat_options")||{},r=u.STORAGE_KEYS.USER_TID_STORAGE_KEY,i=o.default.get("xhstat_tid")||a.default.getStorageSync(r);i||(i=this.getUnitCookieId(),a.default.setStorageSync(r,i));var s=o.default.get("xhstat_sysInfo")||wx.getSystemInfoSync(),f=o.default.get("xhstat_Location");u.SDK_CONFIG.SHOULD_GET_LOCATION&&!f?wx.getLocation({type:"wgs84",success:function(r){t.setData(n,i,s,r),e()}}):(this.setData(n,i,s,f),e())}},{key:"getShareEventId",value:function(){return this.getUnitCookieId().slice(10)}},{key:"getUnitCookieId",value:function(){return""+Date.now()+Math.floor(1e7*Math.random())}},{key:"getSDKCookieId",value:function(){var e=this,t=u.STORAGE_KEYS.USER_TID_STORAGE_KEY;return Promise.resolve().then(function(){return a.default.getStorage(t)}).then(function(n){return n||(n=e.getUnitCookieId(),a.default.setStorage(t,n))})}},{key:"getChannelCode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.query=e.query||{};var t=e.query.channelCode;t||(t=((e.referrerInfo||{}).extraData||{}).channelCode);if(!t){var n=e.query.extraParam||"{}";try{n=JSON.parse(n)}catch(e){n={}}t=n.channelCode}return t}},{key:"getData",value:function(e){var t=this;return e&&o.default.set("xhstat_options",e),s||(s=Promise.all([this.getSDKCookieId(),a.default.getSystemInfo(),u.SDK_CONFIG.SHOULD_GET_LOCATION?a.default.getLocationInfo():Promise.resolve({})])),s.then(function(n){t.setData.apply(t,[e].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n)))})}},{key:"setData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2],r=arguments[3],u=e.query||{},i={xhstat_tid:t,xhstat_sysInfo:n,xhstat_Location:r},s=this.getChannelCode(e),f=void 0,c=void 0;a.default.isRuningMiniPro()&&(f=u.shareId||"",c=u.shareId2||""),a.default.isRuningMiniGame()&&(f=u.sid||"",c=u.sid2||""),u.seid&&(i.seid=u.seid),e.scene&&(i.xhstat_options_scene=e.scene),s&&(i.xhstat_channelCode=s),f&&(i.xhstat_shareId=f),c&&(i.xhstat_shareId2=c),o.default.set(i)}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=(s(n(17)),s(n(18))),o=(s(n(21)),n(19)),u=s(n(22)),i=s(n(20));function s(e){return e&&e.__esModule?e:{default:e}}var f=0,c="test"===o.SDK_CONFIG.ENV?10:100,l={},d={};t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"send",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.list,r=void 0===n?[]:n,o=Date.now();if((r=r.filter(function(t){var n=t.tiger_position_id+"_"+t.creative_id+"_"+e,r=l[n];return!(r&&o-r<6e4||d[n]>=c)})).length){var s=i.default.packLogData(e,t),g=this;u.default.getDataSync(function(){wx.request({url:a.default.API_LIST.tigerBehaviour(),data:s,method:"POST",success:function(t){r.forEach(function(t){var n=t.tiger_position_id+"_"+t.creative_id+"_"+e;l[n]=Date.now(),d[n]=d[n]||0,d[n]+=1}),f=0},fail:function(){if(f<5)return f+=1,g.send(e,t);f=0}})})}}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=u(n(18)),o=(n(19),u(n(20)));function u(e){return e&&e.__esModule?e:{default:e}}var i=0,s=0,f=0,c={appLoaded:"t1",progressStart:"t2",progressEnd:"t3"};t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"send",value:function(e){var t={},n=c[e];if("t1"===n)0===i&&(i=Date.now(),t=o.default.packLogData(n,{timeToStart:0}));else if("t2"===n)if(i){if(0!==s)return void console.warn("progressStart日志只能发送一次");var r=(s=Date.now())-i;t=o.default.packLogData(n,{timeToStart:r,timeToLast:r})}else console.error("progressStart类型日志必须在appLoaded(应用加载)日志之后发送");else if("t3"===n)if(s){if(0!==f)return void console.warn("progressEnd日志只能发送一次");var u=(f=Date.now())-i,l=f-s;t=o.default.packLogData(n,{timeToStart:u,timeToLast:l})}else console.error("progressEnd类型日志必须在progressStart之后发送");t.userLog?a.default.postLoadingLog(t):console.error("请传入正确日志的类型")}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=u(n(18)),o=u(n(21));function u(e){return e&&e.__esModule?e:{default:e}}var i="";t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"stop",value:function(){i&&clearInterval(i),i=""}},{key:"start",value:function(){var e=o.default.get("xhstat_uuid"),t=o.default.get("userInfo")&&o.default.get("userInfo").ofp;!i&&e&&t&&(a.default.postHeartBeatRecord({uid:e,uidfp:t}),i=setInterval(function(){a.default.postHeartBeatRecord({uid:e,uidfp:t})},5e3))}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=s(n(17)),o=(s(n(18)),s(n(21))),u=(n(19),s(n(22))),i=s(n(27));function s(e){return e&&e.__esModule?e:{default:e}}t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"onApp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(arguments[1],e.channelCode),n=o.default.get("xhstat_uuid"),r=o.default.get("xhstat_shareId"),s=o.default.get("xhstat_shareId2"),f=e.success||function(){},c={seid:u.default.getShareEventId()};if(t&&(c.channelCode=t),s&&r?(r=s,s=n):r?s=n:r=n,Object.assign(c,r?{shareId:r}:{}),Object.assign(c,s?{shareId2:s}:{}),(e=a.default.deepClone(e)).path){var l=e.path;e.path=a.default.addQuery(l,c)}else e.path=a.default.addQuery(a.default.getCurrentRoute(),c);return e.success=function(e){i.default.sendSync("sharesuccess"),f(e),console.log("share success")},u.default.getDataSync(function(){return i.default.sendSync("share")}),console.log("shareConfig",e),e}},{key:"emitGame",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u.default.getData().then(function(){return i.default.send("share",{sid:o.default.get("xhstat_uuid")})});var t=e.query,n=o.default.get("xhstat_uuid"),r=o.default.get("xhstat_shareId"),s=o.default.get("xhstat_shareId2"),f=e.channelCode,c={seid:u.default.getShareEventId()},l=e.success||function(){};f&&(c.channelCode=f),s&&r?(r=s,s=n):r?s=n:r=n,Object.assign(c,r?{sid:r}:{}),Object.assign(c,s?{sid2:s}:{}),e.query=t?t+"&"+a.default.stringifyQuery(c):a.default.stringifyQuery(c),e.success=function(e){i.default.sendSync("sharesuccess"),l(e),console.log("share success")},console.log("shareConfig",e),wx.shareAppMessage(e)}},{key:"onGame",value:function(e){wx.onShareAppMessage(function(){var t=(e=e||function(){})()||{};t=a.default.deepClone(t);var n=o.default.get("xhstat_uuid"),r=o.default.get("xhstat_shareId"),s=o.default.get("xhstat_shareId2"),f=t.success||function(){},c=t.channelCode,l=t.query,d={seid:u.default.getShareEventId()};return c&&(d.channelCode=c),s&&r?(r=s,s=n):r?s=n:r=n,Object.assign(d,r?{sid:r}:{}),Object.assign(d,s?{sid2:s}:{}),t.query=l?l+"&"+a.default.stringifyQuery(d):a.default.stringifyQuery(d),t.success=function(e){i.default.sendSync("sharesuccess"),f(e),console.log("share success")},u.default.getDataSync(function(){return i.default.sendSync("share")}),console.log("shareConfig",t),t})}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=i(n(17)),o=i(n(18)),u=(i(n(21)),i(n(20)));function i(e){return e&&e.__esModule?e:{default:e}}t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"send",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1];return Promise.resolve().then(function(){return u.default.packLogData(e,t)}).then(function(e){if(e.userLog.ext.uid)return o.default.postBehaviorLog(e)}).catch(function(e){console.error("[sendLog error]",e)})}},{key:"sendSync",value:function(e,t){var n=u.default.packLogData(e,t);if(n.userLog.ext.uid){var r=o.default.API_LIST.behaviorLog(),i={"content-type":"application/json"};console.warn("发起请求:",r),console.warn("请求header:",i),console.warn("请求body:",n),wx.request({url:r,header:i,data:n,method:"POST",complete:function(e){console.warn("请求response: ",e),console.warn("返回:",a.default.normalizeRes(e))}})}}}]),e}())}]);
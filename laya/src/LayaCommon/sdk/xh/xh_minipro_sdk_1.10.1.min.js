module.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=18)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=function(){"function W {X}function 2 {z}function C {7}function n {U}function E {W}function d {f}function b {l}function a {2}";return new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"isCocosGame",value:function(){return this.isRuningMiniGame()&&"object"===("undefined"==typeof cc?"undefined":i(cc))&&"object"===i(cc.sys)&&cc.sys.platform===cc.sys.WECHAT_GAME}},{key:"isLayaGame",value:function(){return this.isRuningMiniGame()&&"object"===("undefined"==typeof Laya?"undefined":i(Laya))&&"function"==typeof Laya.Browser&&i(Laya.Browser.onWeiXin)}},{key:"addPreHook",value:function(e,t){var n=["onShareAppMessage"],i=null;"App"===e&&(i=App),"Page"===e&&(i=Page);var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=function(i){var r=t[i]||function(){};if(e[i]){var o=e[i];e[i]=function(){for(var e=this,t=arguments.length,a=Array(t),c=0;c<t;c++)a[c]=arguments[c];if(n.indexOf(i)>-1){var u=o.apply(this,a);return r.call.apply(r,[this,u].concat(a))}var s=r.apply(this,a);s&&s.then?s.then(function(){return o.apply(e,a)}):o.apply(this,a)}}else e[i]=r};for(var o in t)r(o);i(e)};"App"===e&&(App=r),"Page"===e&&(Page=r)}},{key:"nextShow",value:function(){var e=this;return new Promise(function(t,n){e.isRuningMiniPro()?"function"==typeof wx.onAppShow?wx.onAppShow(function(e){t(e)}):console.log("当前基础库版本过低不支持该api"):e.isRuningMiniGame()?wx.onShow(function(e){t(e)}):t()})}},{key:"normalizeRes",value:function(e){return e.errMsg||e.statusCode?e.data?{err:e.data.err||0,code:e.statusCode,message:e.data.msg,data:e.data.data}:{err:1,code:e.statusCode||e.errCode||999,message:e.errMsg}:{err:e.err,code:e.statusCode,message:"string"==typeof e?e:e.msg,data:e.data}}},{key:"cutStringAndBackWidth",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=t*n,r=e.length,o=0;if(r>n){for(var a=0;a<r;a++)if(e.charCodeAt(a)>127||94==e.charCodeAt(a)?o+=t:o+=t/2,o>i){e=e.substr(0,a)+"...",o+=t/2;break}}else o=t*r;return{string:e,width:o}}},{key:"isHighViewPhone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.width,n=void 0===t?0:t,i=e.height;return(n/(void 0===i?0:i)).toFixed(2)<(9/16).toFixed(2)}},{key:"wxImageLoader",value:function(e){var t=wx.createImage();return new Promise(function(n,i){t.onload=function(){n(t)},t.onerror=function(e){i(e.message||e)},t.src=e})}},{key:"promiseFy",value:function(e,t){var n={};if(t)for(var i in t)n[i]=t[i];return new Promise(function(t,i){n.success=function(e){(200===e.statusCode||e.errMsg.indexOf(":ok")>-1)&&t(e)},n.fail=function(e){i(o.normalizeRes(e))},e?e.call(wx,n):i({message:"miniProgramFn is not defined"})})}},{key:"addQuery",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=o.stringifyQuery(t);return n?e.indexOf("?")>-1?e+"&"+n:e+"?"+n:e}},{key:"parseQuery",value:function(e){if("string"==typeof e&&e.indexOf("=")>-1){var t={};try{(e.indexOf("?")>-1?e.split("?")[1].split("&"):e.split("&")).forEach(function(e){var n=e.split("=");n&&n.length>1&&(t[n[0]]=n[1])})}catch(e){}return t}return{}}},{key:"stringifyQuery",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];for(var n in e){var i=e[n];i="string"==typeof i?i:"number"==typeof i&&isNaN(i)?"NaN":void 0===i?"undefined":JSON.stringify(i),t.push([n+"="+i])}return t.join("&")}},{key:"getCurrentRoute",value:function(){var e=getCurrentPages();return"/"+e[e.length-1].route}},{key:"getCurrentOptions",value:function(){var e=getCurrentPages();return e[e.length-1].options}},{key:"getCurrentFullUrl",value:function(){var e=o.getCurrentRoute(),t=o.getCurrentOptions();return o.addQuery(e,t)}},{key:"getNetWorkStatus",value:function(){var e=this;return this.getNetWorkStatusPromise||(this.getNetWorkStatusPromise=this.promiseFy(wx.getNetworkType),wx.onNetworkStatusChange(function(t){e.currNetWorkType=t.networkType})),Promise.resolve().then(function(){return e.getNetWorkStatusPromise}).then(function(t){return e.currNetWorkType?e.currNetWorkType:t.networkType}).catch(function(e){return{}})}},{key:"getSystemInfo",value:function(){return o.promiseFy(wx.getSystemInfo).catch(function(e){return{}})}},{key:"setStorage",value:function(e,t){return o.promiseFy(wx.setStorage,{key:e,data:t}).then(function(){return t}).catch(function(){})}},{key:"getStorage",value:function(e){return o.promiseFy(wx.getStorage,{key:e}).then(function(e){return e.data}).catch(function(){return""})}},{key:"checkSessionValidation",value:function(){return o.promiseFy(wx.checkSession).then(function(){return!0}).catch(function(){return!1})}},{key:"isRuningMiniPro",value:function(){return"function"==typeof getApp&&"undefined"==typeof GameGlobal&&"undefined"!=typeof wx}},{key:"isRuningMiniGame",value:function(){return"function"!=typeof getApp&&"undefined"!=typeof GameGlobal&&"undefined"!=typeof wx}},{key:"isEmptyObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"{}"===JSON.stringify(e)}},{key:"makeResponse",value:function(e){var t=e.code,n=void 0===t?200:t,i=e.message,r=e.err;return{err:void 0===r?0:r,code:n,message:i}}},{key:"getVariableType",value:function(e){return Object.prototype.toString.call(e).slice(8,-1)}},{key:"deepClone",value:function(e){var t=o.getVariableType(e),n=void 0;if("Object"===t&&(n={}),"Array"===t&&(n=[]),!n)return e;for(var i in e){var r=e[i],a=o.getVariableType(r),c="Object"===a||"Array"===a;n[i]=c?o.deepClone(r):r}return n}},{key:"getOSbySystemInfo",value:function(){var e=((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).system||"").toLowerCase(),t="other";return e.indexOf("ios")>-1&&(t="ios"),e.indexOf("android")>-1&&(t="android"),t}},{key:"checkExpireByServerTimeFormat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!0;try{n=new Date(e).getTime()<=Date.now()+t}catch(e){}return n}},{key:"normalErrorHandler",value:function(e){var t=e.message,n=void 0===t?"程序错误":t;return Promise.resolve().then(function(){return o.promiseFy(wx.showModal,{content:n,showCancel:!1})})}},{key:"sleep",value:function(e){return new Promise(function(t){return setTimeout(t,e)})}}]),e}())}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));var o=function(){var e={xhstat_nwt:"",xhstat_sysInfo:{},xhstat_channelCode:"",xhstat_tid:"",xhstat_uuid:"",xhstat_sessionId:""};function t(n,i){if("String"===r.default.getVariableType(n))return t(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},n,i));e=Object.assign({},e,n)}return new(function(){function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)}return i(n,[{key:"set",value:function(){return t.apply(void 0,arguments)}},{key:"get",value:function(){return function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(n){var o=n.split(".");if(o.length>1){var a=i[o[0]];return void 0!==a?t(o.slice(1).join("."),a):void 0}return r.default.deepClone(i[n])}return r.default.deepClone(i)}.apply(void 0,arguments)}}]),n}())}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),r=u(n(0)),o=u(n(1)),a=u(n(8)),c=u(n(9));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(){var e=null,t=null,n={test:"https://test.kuaiyugo.com"},u={test:"https://cdn.kuaiyugo.com",prod:"https://cdn.kuaiyugo.com"},d=function(){return n[i.SDK_CONFIG.ENV]+"/api/tiger/v1/config"},l=function(){return n[i.SDK_CONFIG.ENV]+"/api/tiger/v1/qrcode"},f=function(e){return n[i.SDK_CONFIG.ENV]+"/api/tiger/v1/delivery/"+e},g=function(){return n[i.SDK_CONFIG.ENV]+"/api/platuser/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/miniprogram_sessions"},h=function(){return n[i.SDK_CONFIG.ENV]+"/api/oauth/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/authroizes"},p=function(){return n[i.SDK_CONFIG.ENV]+"/api/oauth/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/access_tokens"},v=function(){return n[i.SDK_CONFIG.ENV]+"/api/oauth/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/check"},y=function(){return n[i.SDK_CONFIG.ENV]+"/api/payment/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/midas_orders"},_=function(){return n[i.SDK_CONFIG.ENV]+"/api/payment/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/wx_orders"},I=function(){return n[i.SDK_CONFIG.ENV]+"/api/payment/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/pay_types"},m=function(e){return n[i.SDK_CONFIG.ENV]+"/api/payment/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/orders/"+e+"/status"},S=function(){return n[i.SDK_CONFIG.ENV]+"/api/platuser/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/mergers"},C=function(){return n[i.SDK_CONFIG.ENV]+"/api/payment/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/gold_balances"},A=function(){return n[i.SDK_CONFIG.ENV]+"/api/config/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/share_templates"},T=function(){return n[i.SDK_CONFIG.ENV]+"/api/config/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/judge_configs"},k=function(e){return n[i.SDK_CONFIG.ENV]+"/api/payment/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/orders/"+e+"/confirm_pays"},E=function(){return n[i.SDK_CONFIG.ENV]+"/api/payment/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/midas_balances"},w=function(){return n[i.SDK_CONFIG.ENV]+"/api/platuser/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/refresh_session"},P=function(e){return n[i.SDK_CONFIG.ENV]+"/api/payment/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/orders/"+e+"/cancel_orders"},O=function(){return n[i.SDK_CONFIG.ENV]+"/api/config/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/ad_configs"},N=function(){return n[i.SDK_CONFIG.ENV]+"/api/config/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/share_callback_configs"},R=function(){return n[i.SDK_CONFIG.ENV]+"/api/payment/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/error_orders"},b=function(){return n[i.SDK_CONFIG.ENV]+"/api/panda/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/orders"},U=function(e){return n[i.SDK_CONFIG.ENV]+"/api/panda/v1/programs/"+i.SDK_CONFIG.PROGRAM_ID+"/users/"+o.default.get("xhstat_uuid")+"/orders/"+e},x=function(e,t){return n[i.SDK_CONFIG.ENV]+"/api/tiger/v1/checkBackflow?A_app_id="+e+"&B_app_id="+t};function L(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).forceRefresh,t=i.STORAGE_KEYS.AUTH_CODE_INFO_STORAGE_KEY;return Promise.resolve().then(function(){return a.default.fetchUserInfo({openIdOnly:!0})}).then(function(){return r.default.getStorage(t)}).then(function(t){return e?s.getAuthCode():t&&t.expires_at?r.default.checkExpireByServerTimeFormat(t.expires_at,6e4)?s.getAuthCode():(t.fromCache=!0,t):s.getAuthCode()}).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.fromCache?e.code:r.default.setStorage(t,e).then(function(e){return e.code})})}function D(){"function o {l}function M {J}function f {P}function n {b}function U {L}function C {Q}function t {T}function 9 {p}";var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).forceRefresh,n=void 0!==e&&e;return t||(t=Promise.resolve().then(function(){return L({forceRefresh:n})}).then(function(e){return function e(t){var n=t.code,a=t.forceRefresh,c=void 0!==a&&a,u=i.STORAGE_KEYS.ACCESS_TOKEN_INFO_STORAGE_KEY;return Promise.resolve().then(function(){return r.default.getStorage(u)}).then(function(e){return e&&e.expires_at&&!c?r.default.checkExpireByServerTimeFormat(e.expires_at,18e4)?s.getAccessToken({code:n}):(e.fromCache=!0,e):s.getAccessToken({code:n})}).then(function(e){var t=e;return t.fromCache?t.access_token:(o.default.set("xhstat_access_token",t.access_token),r.default.setStorage(u,t).then(function(e){return e.access_token}))}).catch(function(t){if(1013===t.err)return L({forceRefresh:!0}).then(function(t){return e({code:t})});console.error(t)})}({code:e,forceRefresh:n})}).then(function(e){return t=null,e})),t}var G={getTigerGlobalConfig:{method:"GET",urlMaker:function(){return d()},noAccessToken:!0},getTigerQrcode:{method:"GET",urlMaker:function(){return l()},noAccessToken:!0,dataMaker:function(e){var t=e.creative_id;return{tiger_position_id:e.tiger_position_id,creative_id:t}}},getTigerList:{method:"GET",urlMaker:function(e){var t=e.tiger_position_id;return f(t)},dataMaker:function(e){var t=e.version;return{gender:e.gender,version:t,openid:e.openid}}},postUserInfo:{method:"POST",urlMaker:function(e){return g()},dataMaker:function(e){return{auth_mode:e.auth_mode,wx_code:e.wx_code,wx_encrypted_data:e.wx_encrypted_data,wx_iv:e.wx_iv,wx_signature:e.wx_signature}},headerMaker:function(){return B()},noAccessToken:!0},postUpdateUserInfo:{method:"POST",urlMaker:function(e){return g()},dataMaker:function(e){var t=e.userInfoDetail;return{openId:o.default.get("xhstat_uuid"),appId:i.SDK_CONFIG.APPID,encryptedData:t.encryptedData,iv:t.iv,signature:t.signature,rawData:t.rawData}},noAccessToken:!0},getAuthCode:{method:"GET",urlMaker:function(e){return h()},dataMaker:function(){return{openid:o.default.get("xhstat_uuid"),scope:"snsapi_base",redirect_uri:"https://www.starsriver.cn",response_type:"code",state:"code"}},noAccessToken:!0},getAccessToken:{method:"GET",urlMaker:function(e){return p()},dataMaker:function(e){var t=e.code;return{programId:i.SDK_CONFIG.PROGRAM_ID,openid:o.default.get("xhstat_uuid"),grant_type:"authorization_code",code:t,program_secret:i.SDK_CONFIG.PROGRAM_SECRET}},noAccessToken:!0},postCheckUserAccountStatus:{method:"POST",urlMaker:function(e){return v()},dataMaker:function(){return{}}},postCreateMidasPayOrder:{method:"POST",urlMaker:function(e){return y()},dataMaker:function(e){return{coin:e.coin,program_param:e.program_param}}},platuserRefreshSession:{method:"GET",urlMaker:function(){return w()},dataMaker:function(e){return{wx_code:e.wx_code}}},postCreateWxPayOrder:{method:"POST",urlMaker:function(e){return _()},dataMaker:function(e){return{coin:e.coin,program_param:e.program_param}}},getCheckPayType:{method:"GET",urlMaker:function(e){return I()},dataMaker:function(){return{}}},getCheckOrderStatus:{method:"GET",urlMaker:function(e){return m(e)},dataMaker:function(){return{}}},postMergeAccounts:{method:"POST",urlMaker:function(e){return S()},dataMaker:function(e){return{clipboard:e.clipboard}}},putUpdateGoldBalance:{method:"PUT",urlMaker:function(){return C()},dataMaker:function(e){return{gold:e.gold,transaction_type:e.transaction_type,gold_desc:e.gold_desc}}},getGoldBalance:{method:"GET",urlMaker:function(){return C()},dataMaker:function(){return{}}},getShareTemplate:{method:"GET",urlMaker:function(){return A()},dataMaker:function(e){return{version:e.version,openid:o.default.get("xhstat_uuid")}}},getGameSwitchConfig:{method:"GET",urlMaker:function(){return T()},dataMaker:function(e){return{version:e.version,programId:i.SDK_CONFIG.PROGRAM_ID}}},putConfirmPay:{method:"PUT",urlMaker:function(e){return k(e)},dataMaker:function(){return{}}},putCancelPay:{method:"PUT",urlMaker:function(e){return P(e)},dataMaker:function(){return{}}},putUpdateMidasBalance:{method:"PUT",urlMaker:function(e){return E()},dataMaker:function(){return{}}},getFloatAdConfig:{method:"GET",urlMaker:function(){return O()},dataMaker:function(e){return{type:4,app_version:e.app_version}}},getFirstScreenAdConfig:{method:"GET",urlMaker:function(){return O()},dataMaker:function(e){return{type:1,app_version:e.app_version}}},shareCallbackConfigs:{method:"GET",urlMaker:function(){return N()},headerMaker:function(){return B()},dataMaker:function(e){var t=e.version;return{programId:i.SDK_CONFIG.PROGRAM_ID,version:t}}},postPayErrorLog:{method:"POST",urlMaker:function(){return R()},dataMaker:function(e){var t=e.order_code;return{msg:e.msg,order_code:t}},headerMaker:function(){return B()}},postCreateH5PayOrder:{method:"POST",urlMaker:function(e){return b()},dataMaker:function(e){return{amount:e.amount,program_param:e.program_param}}},getH5PayOrderStatus:{method:"GET",urlMaker:function(e){return U(e)},dataMaker:function(){return{}}},getBackBtnGameInfo:{method:"GET",urlMaker:function(e){var t=e.A_app_id,n=e.B_app_id;return x(t,n)},dataMaker:function(){return{}}}};function M(t){"function V {r}function a {e}function P {6}function y {6}function b {N}function 5 {m}function E {6}function q {Y}";t.apiName;var o=t.urlMaker,a=t.dataMaker,u=t.method,d=void 0===u?"GET":u,l=t.headerMaker,f=t.noAccessToken,g=void 0!==f&&f,h=t.noLog,p=void 0!==h&&h;var v=null,y=0;return v=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Promise.resolve().then(function(){return c.default.networkRelink()}).then(function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e||"test"===i.SDK_CONFIG.ENV||(e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=r.default.getVariableType(t);return"String"===n?Promise.resolve(t):0===t.length?Promise.reject(r.default.makeResponse(i.RESPONSE.NO_AVAILABLE_HOST)):Promise.resolve().then(function(){return r.default.promiseFy(wx.request,{url:t[0]})}).then(function(){return e(t[0])}).catch(function(){return e(t.slice(1))})}(t).then(function(e){n[i.SDK_CONFIG.ENV]=e})),e}(i.SPARE_HOSTS_LIST)}).then(function(){if(!g)return D()}).then(function(){return r.default.promiseFy(wx.request,{url:o(t),method:d,data:a&&a(t),header:l?l(t):B()})}).catch(function(e){var t=r.default.normalizeRes(e);return Promise.reject(t)}).then(function(e){var n=r.default.normalizeRes(e);try{!p&&s.REQUEST_LOG&&(console.warn("发起请求:"+d+o(t)),console.warn("请求Header: "+JSON.stringify(l?l(t):B())),console.warn("请求body: "+JSON.stringify(a&&a(t))),console.warn("请求response: ",e),console.warn("返回: ",n))}catch(e){console.error("请求日志打印时报错"+e)}return 0===n.err?Promise.resolve(n.data):i.ACCESS_TOKEN_EXPIRED_CODE.indexOf(n.err)>-1&&++y<i.MAX_LOGIN_RETRY_TIMES?D({forceRefresh:!0}).then(function(){return v(t)}):Promise.reject(n)})}}function B(){var e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).noAccessToken,t={miniprogram:i.SDK_CONFIG.APPID,version:i.SDK_CONFIG.SDKVERSION,device:o.default.get("xhstat_os")};return e||(t.accesstoken=o.default.get("xhstat_access_token")),t}return new function e(){"function v {Q}function M {g}function W {Q}function I {0}function v {q}function Y {9}function h {I}function V {i}";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(){for(var e in G){var t=G[e];t.apiName=e,this[e]=M(t),this.REQUEST_LOG=!0}}.call(this),this.RES_HOST=u[i.SDK_CONFIG.ENV]}}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=s(n(0)),o=s(n(8)),a=s(n(1)),c=s(n(9)),u=(s(n(14)),n(6));function s(e){return e&&e.__esModule?e:{default:e}}var d=!1;t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"switchRequestLog",value:function(e){var t=e.open,n=this.getStatisticSDK();n.switchRequestLog&&n.switchRequestLog({open:t})}},{key:"sendLog",value:function(e,t){var n=this;return o.default.fetchUserInfo({openIdOnly:!0}).then(function(){var i=n.getStatisticSDK();return i.sendLog&&i.sendLog(e,t)})}},{key:"sendTigerBehaviourSync",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};("render"!=e||c.default.APP_IS_SHOW)&&o.default.fetchUserInfo({openIdOnly:!0}).then(function(){var i=t.getStatisticSDK();i.sendTigerBehaviourSync&&i.sendTigerBehaviourSync(e,n)})}},{key:"sendTigerBehaviourBackButtonSync",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o.default.fetchUserInfo({openIdOnly:!0}).then(function(){var i=t.getStatisticSDK();i.sendTigerBehaviourBackButtonSync&&i.sendTigerBehaviourBackButtonSync(e,n)})}},{key:"getStatisticSDK",value:function(){if(r.default.isRuningMiniGame())return GameGlobal.XH_STATISTIC?GameGlobal.XH_STATISTIC:(console.warn("未接入数据采集SDK"),{});if(r.default.isRuningMiniPro()){if("function"==typeof getApp&&getApp()){var e=getApp().XH_STATISTIC;return e||(console.warn("未接入数据采集SDK"),{})}return console.warn("没有全局getApp方法"),{}}}},{key:"setUserInfoAndSendToStatistic",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).userInfo;if(e){a.default.set({userInfo:e});var t=this.getStatisticSDK();t.sendUserInfo&&t.sendUserInfo(e),t.sendXHSDKVersion&&t.sendXHSDKVersion(u.SDK_CONFIG.SDKVERSION)}}},{key:"sendLoadingLog",value:function(e){if(["progressStart","progressEnd"].indexOf(e)>-1){var t=this.getStatisticSDK();t&&o.default.fetchUserInfo({openIdOnly:!0}).then(function(){t.sendLoadingLog&&t.sendLoadingLog(e)})}else console.error("只支持传入两种类型：1、progressStart(进度条开始加载), 2、progressEnd(进度条加载完成)")}},{key:"sendStatsticLogAndInfo",value:function(){var e=this;arguments.length>0&&void 0!==arguments[0]&&arguments[0];d||o.default.fetchUserInfo({openIdOnly:!0}).then(function(){var t=e.getStatisticSDK();t.sendHeartBeatRecord&&t.sendHeartBeatRecord(),t.sendLog&&t.sendLog("login_in"),d=!0})}},{key:"sendShareCallBackConfig",value:function(e){var t=this.getStatisticSDK();t.sendShareCallBackConfig&&t.sendShareCallBackConfig(e)}}]),e}())},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=t.SDK_CONFIG={ENV:"prod",APPKEY:"238a9df0-38af-11e9-97fa-8972ddb31682",APPID:"wx0221e8a77695c6ed",PROGRAM_ID:"238a9df138af11e997fa8972ddb31682",PROGRAM_SECRET:"238a9df238af11e997fa8972ddb31682",SDKVERSION:"1.10.1",JUMP_MINI_PROGRAM_ENV:"release"};t.MAX_LOGIN_RETRY_TIMES=3,t.ACCESS_TOKEN_EXPIRED_CODE=[1304,1021,1022,1020],t.SDK_ERROR_CODES={NO_MERGE_ERROR:{err:50001,message:"没有发起合并账户操作"}},t.SPARE_HOSTS_LIST="test"===i.ENV?["https://test.kuaiyugo.com"]:['https://api.kuaiyugo.com','https://api.51yxstar.com','https://api.51staryule.com','https://api.51sfske.com'],t.MAX_PAY_RETRY_TIMES=15,t.PAY_RETRY_INTERVAL=1e3,t.RESPONSE={NO_AVAILABLE_HOST:{message:"NO_AVAILABLE_HOST"},USER_PAY_DISABLED:{message:"USER_PAY_DISABLED"},CHECK_ORDER_TIME_OUT:{message:"CHECK_ORDER_TIME_OUT"},PAY_FAIL:{message:"PAY_FAIL"},PAY_SUCCESS:{message:"PAY_SUCCESS"},NO_AD_CONFIG:{message:"NO_AD_CONFIG"},H5PAY_FAIL_SELLER_DELIVER_FAIL:{message:"H5PAY_FAIL_SELLER_DELIVER_FAIL"},H5PAY_FAIL_PAY_ERROR:{message:"H5PAY_FAIL_PAY_ERROR"},H5PAY_FAIL_BUYER_NOT_PAY:{message:"H5PAY_FAIL_BUYER_NOT_PAY"},H5PAY_FAIL_SELL_NOT_DELIVERY:{message:"H5PAY_FAIL_SELL_NOT_DELIVERY"}},t.STORAGE_KEYS={USER_TID_STORAGE_KEY:"XH_USER_TID",CHANNEL_CODE_STORAGE_KEY:"XH_CHANNEL_CODE",AUTH_CODE_INFO_STORAGE_KEY:"XH_AUTH_CODE_INFO",ACCESS_TOKEN_INFO_STORAGE_KEY:"ACCESS_TOKEN_INFO",ACCOUNT_MERGE_RECORDS_STORAGE_KEY:"ACCOUNT_MERGE_RECORDS",GET_NEW_DATE_ASTRICT_KEY:"GET_NEW_DATE"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTigerStyle=t.tigerUIType=t.tigerUIApi=t.setSpriteImage=t.PRE_TIGER_REFRESH=t.standardCanvasSize=t.exitAnimationType=t.AdvEnterAnimationType=t.clickAnimationType=t.AdvDynamicType=t.DEFAULT_NODE_INDEX=t.getConfigImages=t.checkIsRunEnterSceneAction=t.runCallBack=t.deleteCallBack=t.addCallBack=t.initIconTigerNode=t.initBlinkTigerNode=t.loadBlinkIcon=t.reRenderTigerToView=t.fpsIconLooper=t.tigerUIConfig=t.tigerTapEvent=t.renderTiger=t.initTigerNode=t.startAutoSwitch=t.isNowScene=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=(u(n(1)),u(n(0))),o=u(n(23)),a=u(n(24)),c=n(15);function u(e){return e&&e.__esModule?e:{default:e}}t.isNowScene=Symbol("isNowScene"),t.startAutoSwitch=Symbol("startAutoSwitch"),t.initTigerNode=Symbol("initTigerNode"),t.renderTiger=Symbol("renderTiger"),t.tigerTapEvent=Symbol("tigerTapEvent"),t.tigerUIConfig=Symbol("tigerUIConfig"),t.fpsIconLooper=Symbol("fpsIconLooper"),t.reRenderTigerToView=Symbol("reRenderTigerToView"),t.loadBlinkIcon=Symbol("loadBlinkIcon"),t.initBlinkTigerNode=Symbol("initBlinkTigerNode"),t.initIconTigerNode=Symbol("initIconTigerNode"),t.addCallBack=Symbol("addCallBack"),t.deleteCallBack=Symbol("deleteCallBack"),t.runCallBack=Symbol("runCallBack"),t.checkIsRunEnterSceneAction=Symbol("checkIsRunEnterSceneAction"),t.getConfigImages=function(e){return e.show_config.image?[e.show_config.image]:e.show_config.images?e.show_config.images:[]},t.DEFAULT_NODE_INDEX=999999999,t.AdvDynamicType={none:0,easeInOut:1,shake:2,moveByY:3},t.clickAnimationType={none:0,scale:1},t.AdvEnterAnimationType={showToTop:-1,none:0,jumpFromTop:1},t.exitAnimationType={exitToBottom:-1,none:0};var s=t.standardCanvasSize={landscape:{width:1920,height:1080},portrait:{width:1080,height:1920}},d=(t.PRE_TIGER_REFRESH=6e6,{}),l=t.setSpriteImage=function(e,t,n){return new Promise(function(i,o){if(!(e&&e instanceof cc.Node))return o("请传入正确的节点");if(!t)return o("请传入正确的资源路径");var a=function(e,t){if(cc.isValid(e)){var i=e.getComponent(cc.Sprite);if(n){var r=n.rectX||0,o=n.rectY||0,a=n.rectW||0,c=n.rectH||0,u=n.rectXPercent,s=n.rectYPercent,d=n.rectWPercent,l=n.rectHPercent,f=u>=0&&u<1?t.width*u:r,g=s>=0&&s<1?t.height*s:o,h=d>=0&&d<=1?t.width*d:a,p=l>=0&&l<=1?t.height*l:c,v=cc.rect(f,g,h,p);i.spriteFrame=new cc.SpriteFrame(t,v)}else i.spriteFrame=new cc.SpriteFrame(t)}};d[t]?(a(e,d[t]),i()):0===t.indexOf(wx.env.USER_DATA_PATH)?cc.loader.load(t,function(n,r){d[t]=r,a(e,r),i()}):r.default.wxImageLoader(t).then(function(n){if(cc.isValid(e)&&e.active){var r=new cc.Texture2D;r.initWithElement(n),r.handleLoadedTexture(),d[t]=r,a(e,r),i()}}).catch(o)})},f=t.tigerUIApi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"scaleSizeInCanvas",value:function(e){return e*(this.getWinSize().width/375)}},{key:"runAction",value:function(e,t,n){r.default.isCocosGame()?o.default.show(e,t,n):r.default.isLayaGame()&&a.default.show(e,t,n)}},{key:"runEnterSceneAction",value:function(e,t,n){return 0===t?Promise.resolve():r.default.isCocosGame()?o.default.enter(e,t,n):Promise.resolve()}},{key:"runExitSceneAction",value:function(e,t,n){return new Promise(function(i,a){r.default.isCocosGame()?o.default.exit(e,t,n).then(function(){i()}):i()})}},{key:"sceneIsInit",value:function(){return!!(r.default.isCocosGame()&&cc&&cc.director&&cc.director.getScene()||r.default.isLayaGame()&&Laya&&Laya.stage)||(console.error("[createTiger]: 场景未初始化"),!1)}},{key:"getSceneChildByName",value:function(e){return this.sceneIsInit()?r.default.isCocosGame()?cc.director.getScene().getChildByName(e):r.default.isLayaGame()?Laya.stage.getChildByName(e):void 0:void 0}},{key:"getNode",value:function(e){return r.default.isCocosGame()?e.node:e}},{key:"createLabelNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.parent,i=t.style,o="";return r.default.isCocosGame()&&((o=new cc.Node(e)).addComponent(cc.Label),n?n.addChild(o):cc.director.getScene().addChild(o)),i&&this.setStyle(o,i),o}},{key:"transparentColor",value:function(e){if(r.default.isCocosGame()){var t=(e=e.replace(/[^0-9,]/g,"")).split(",").map(function(e){return Number(e)});return new(Function.prototype.bind.apply(cc.Color,[null].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t))))}}},{key:"setScrollViewNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r.default.isCocosGame()){var n=e.addComponent(cc.ScrollView);if(t)for(var i in t)n[i]=t[i];return n}}},{key:"createGraphicsRoundRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.color,i=t.borderRadius,o={};return r.default.isCocosGame()&&((o=e.addComponent(cc.Graphics)).clear(),o.fillColor=this.transparentColor(n),o.roundRect(-e.width/2,-e.height/2,e.width,e.height,i),o.fill()),o}},{key:"createNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.parent,i=t.style,o={};return r.default.isCocosGame()?(o=new cc.Node(e),n?n.addChild(o):cc.director.getScene().addChild(o)):r.default.isLayaGame()&&((o=new Laya.Sprite).name=e,n?n.addChild(o):Laya.stage.addChild(o)),i&&this.setStyle(o,i),o}},{key:"setStyle",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.width,o=n.height,a=n.x,u=n.y,s=n.zIndex,d=n.opacity,l=n.bgColor,f=n.fontStyle;if(r.default.isCocosGame()){if(void 0!==i&&void 0!==o&&(e.setContentSize(i,o),e.tigerWidth=i,e.tigerHeight=o),void 0!==a&&void 0!==u&&(e.position=this.getStylePosition(e,{width:i,height:o,x:a,y:u})),void 0!==d&&(e.opacity=d),void 0!==l&&this.loadImage(e,c.whiteDotIcon).then(function(){e.color=t.transparentColor(l)}),void 0!==s&&(e.zIndex=s),f){var g=e.getComponent(cc.Label);if(g)for(var h in f)"horizontalAlign"===h?["LEFT","CENTER","RIGHT"].includes(f[h])&&(g[h]=cc.Label.HorizontalAlign[f[h]]):"verticalAlign"===h?["TOP","CENTER","BOTTOM"].includes(f[h])&&(g[h]=cc.Label.VerticalAlign[f[h]]):g[h]=f[h]||g[h];void 0!==f.color&&(e.color=this.transparentColor(f.color))}}else if(r.default.isLayaGame()){var p=this.getStylePosition(e,{width:i,height:o,x:a,y:u});e.x=p.x,e.y=p.y,e.zOrder=s,e.tigerWidth=i,e.tigerHeight=o,e.width=i,e.height=o}}},{key:"getStylePosition",value:function(e,t){var n=t.width,i=void 0===n?0:n,o=t.height,a=void 0===o?0:o,c=t.x,u=t.y;if(r.default.isCocosGame()){var s=cc.isValid(e.parent),d=(e.parent.parent,e.anchorX*i+c),l=e.anchorY*a+u,f=s?e.parent.width*e.parent.anchorX:0,g=s?e.parent.height*e.parent.anchorY:0;return{x:d-f,y:this.getWinSize().height-l-g}}return{x:c,y:u}}},{key:"setNodeClickScaleTransition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.duration,i=t.scale;if(r.default.isCocosGame()){var o=e.getComponent(cc.Button);o||(o=e.addComponent(cc.Button)),o.transition=cc.Button.Transition.SCALE,o.duration=Number(n)||.1,o.zoomScale=Number(i)||1.2}}},{key:"getWinSize",value:function(){return this.sceneIsInit()?r.default.isCocosGame()?{width:cc.winSize.width,height:cc.winSize.height}:r.default.isLayaGame()?{width:Laya.stage.width,height:Laya.stage.height}:s:s}},{key:"getSceneId",value:function(){return this.sceneIsInit()?r.default.isCocosGame()?cc.director.getScene()._id:r.default.isLayaGame()?Laya.stage.$_GID:void 0:void 0}},{key:"loadImage",value:function(e,t,n){return new Promise(function(i,o){if(r.default.isCocosGame())if(cc.isValid(e)){var a=e.getComponent(cc.Sprite);a||(a=e.addComponent(cc.Sprite)),a.sizeMode=cc.Sprite.SizeMode.CUSTOM,l(e,t,n).then(function(){e.setContentSize(e.tigerWidth,e.tigerHeight),i()}).catch(o)}else i();else if(r.default.isLayaGame()){var c=Laya.version&&Laya.version.split(".")[0];c<2?(e.graphics.clear(),e.loadImage(t,0,0,e.tigerWidth,e.tigerHeight,Laya.Handler.create(Laya,function(){i()}),Laya.Handler.create(Laya,function(){o()}))):c>=2&&e.loadImage(t,Laya.Handler.create(Laya,function(){i()}))}else console.error("[setNodeImage] 当前引擎环境不兼容此方法")})}},{key:"isVisible",value:function(e){return r.default.isCocosGame()?e.active:!!r.default.isLayaGame()&&e.visible}},{key:"isDestroy",value:function(e){return r.default.isCocosGame()?!cc.isValid(e):!!r.default.isLayaGame()&&e.destroyed}},{key:"isNowScene",value:function(e){return this.getSceneId()===e}},{key:"bindTap",value:function(e){var t=e.node,n=e.type,i=e.callback;if(r.default.isCocosGame()||r.default.isLayaGame())switch(n){case"touch":default:this.bindTouch(t,i)}else console.warn("[bindTap] 当前引擎环境不兼容此方法")}},{key:"bindTouch",value:function(e,t){r.default.isCocosGame()?cc.isValid(e)&&(e.getComponent(cc.Button)||e.addComponent(cc.Button),"Function"===r.default.getVariableType(t)&&e.on("click",t)):r.default.isLayaGame()?"Function"===r.default.getVariableType(t)&&e.on(Laya.Event.CLICK,e,t):console.warn("[bindTap] 当前引擎环境不兼容此方法")}}]),e}();t.tigerUIType={staticIcon:1,dynamicIcon:2,blinkIcon:3,horizontalBlinkIcon:8,recommend:9,fakeVideo:11},t.getTigerStyle=function(){return{1:{w:190,h:270},2:{w:190,h:270},3:{w:f.getWinSize().width,h:f.getWinSize().height},8:{w:f.getWinSize().width,h:f.getWinSize().height}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=u(n(0)),o=u(n(2)),a=u(n(1)),c=u(n(3));u(n(9));function u(e){return e&&e.__esModule?e:{default:e}}var s=0,d=null,l=!1;t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"fetchUserInfo",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).openIdOnly;return d&&(void 0!==t&&t)||(d=Promise.resolve().then(function(){return r.default.promiseFy(wx.login)}).then(function(e){return o.default.postUserInfo({auth_mode:"default",wx_code:e.code})}).then(function(e){return a.default.set({xhstat_uuid:e.open_id}),c.default.setUserInfoAndSendToStatistic({userInfo:e}),s=0,l||(l=o.default.putUpdateMidasBalance().catch(function(){return l=!1})),e}).catch(function(t){return 1026===t.err&&s<5?(s+=1,e.fetchUserInfo({openIdOnly:!1})):(s=0,Promise.reject(t))})),d.then(function(){return a.default.get("userInfo")})}},{key:"updateUserInfo",value:function(e){var t=this;return Promise.resolve().then(function(){return r.default.promiseFy(wx.login)}).then(function(t){return o.default.postUserInfo({auth_mode:"full",wx_code:t.code,wx_encrypted_data:e.encryptedData,wx_iv:e.iv,wx_signature:e.signature})}).then(function(e){c.default.setUserInfoAndSendToStatistic({userInfo:e}),s=0;var t=r.default.deepClone(e);return delete t.is_new,t}).catch(function(n){return 1026===n.err&&s<5?(s+=1,t.updateUserInfo(e)):(s=0,Promise.reject(n))})}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(i=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&c.return&&c.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=d(n(2)),a=d(n(1)),c=d(n(0)),u=n(6),s=d(n(3));function d(e){return e&&e.__esModule?e:{default:e}}var l=null;t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.APP_IS_SHOW=!0,this.APP_STATUS_SHOW_STAMPS=[],this.APP_STATUS_HIDE_STAMPS=[],this.API_RETRY_NETWORK_STATUS="none"}return r(e,[{key:"switchRequestLog",value:function(){"function Y {b}function l {Y}function A {s}function i {m}function M {T}function n {B}function 4 {1}function A {o}";var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).open;void 0!==e&&(s.default.switchRequestLog({open:e}),o.default.REQUEST_LOG=e,e||console.error("您已关闭SDK控制台打印日志，请在上线之前重新打开"))}},{key:"navigateToMiniProgram",value:function(){"function g {k}function K {J}function r {8}function H {r}function 6 {u}function v {G}function r {s}function 5 {X}";var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.appId,n=e.path,i=void 0===n?"pages/index/index":n,r=e.extraData,o=e.envVersion,c=void 0===o?"release":o;return new Promise(function(e,n){if(console.log("appId: ",t),t){var o={appId:u.SDK_CONFIG.APPID,openId:a.default.get("xhstat_uuid")};wx.navigateToMiniProgram({appId:t,path:i,extraData:Object.assign({mergeAccount:o},r),envVersion:c,success:e,fail:n})}else n("请传入正确的appId")})}},{key:"fetchInitData",value:function(e){"function b {K}function C {F}function P {O}function 2 {Y}function 2 {t}function C {H}function T {N}function I {J}";Promise.all([c.default.getNetWorkStatus(),c.default.getSystemInfo(),function(){var e=u.STORAGE_KEYS.USER_TID_STORAGE_KEY;return Promise.resolve().then(function(){return c.default.getStorage(e)}).then(function(t){return t||(t=""+Date.now()+Math.floor(1e7*Math.random()),c.default.setStorage(e,t))})}(),c.default.getStorage(u.STORAGE_KEYS.ACCESS_TOKEN_INFO_STORAGE_KEY)]).then(function(t){var n=i(t,4),r=n[0],o=n[1],u=n[2],s=n[3];e.query;a.default.set({xhstat_nwt:r,xhstat_sysInfo:o,xhstat_tid:u,xhstat_access_token:s?s.access_token:"",xhstat_os:c.default.getOSbySystemInfo(o)})})}},{key:"checkDoubleJump",value:function(e){"function k {0}function j {o}function x {A}function z {H}function 9 {N}function C {4}function t {A}function g {R}";if(1037==e.scene){var t="";try{t=JSON.parse(e.query.nextGameJumpConfig)}catch(e){t=""}if(t){var n={channelCode:t.channelCode};t.nextGameJumpConfig&&(n.nextGameJumpConfig=t.nextGameJumpConfig),wx.navigateToMiniProgram({appId:t.app_id,path:c.default.addQuery(t.path||"pages/index/index",n),extraData:n,envVersion:u.SDK_CONFIG.JUMP_MINI_PROGRAM_ENV,success:resolve,fail:reject})}}}},{key:"networkRelink",value:function(){var e=this;return l||(l=new Promise(function(t,n){c.default.getNetWorkStatus().then(function(n){"none"!=n?t():wx.onNetworkStatusChange(function(n){n.isConnected&&"none"==e.API_RETRY_NETWORK_STATUS&&t(),e.API_RETRY_NETWORK_STATUS=n.networkType})}).catch(function(){})})),l}}]),e}())},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=l(n(0)),o=l(n(2)),a=l(n(1)),c=n(6),u=l(n(8)),s=l(n(3)),d=n(7);function l(e){return e&&e.__esModule?e:{default:e}}var f={},g="",h=function(e){return(e=r.default.deepClone(e)).is_open=!!e.show_config,e.show_config&&e.show_config.hasOwnProperty("is_click_change")&&delete e.show_config.is_click_change,delete e.tiger_master_id,delete e.tiger_plan_id,delete e.tiger_group_id,delete e.flow_owner_id,delete e.is_default,delete e.redirect_app_id,delete e.redirect_path,delete e.redirect_version,delete e.redirect_extra_data,delete e.channel_code,delete e.production_app_id,delete e.render_max,e},p=function(e,t,n,i){a.default.get("tigerListCache")||a.default.set("tigerListCache",{}),a.default.get("tigerIndexCache")||a.default.set("tigerIndexCache",{});var r=n.gender||1,c=a.default.get("tigerListCache"),u=a.default.get("tigerIndexCache"),s=Date.now(),l=e.map(function(e){return f[e]=f[e]||Date.now(),c[e]&&s-f[e]<d.PRE_TIGER_REFRESH?(9==c[e][0].type||i||(c[e].length>1?(u[e]+=1,u[e]>c[e].length-1&&(u[e]=0)):u[e]=0,a.default.set("tigerIndexCache",u)),Promise.resolve({list:c[e],index:u[e]})):function(e,t,n,i){return o.default.getTigerList({tiger_position_id:e,version:t,openid:a.default.get("xhstat_uuid"),gender:n}).then(function(t){var n=a.default.get("tigerListCache"),r=a.default.get("tigerIndexCache");return n[e]=t,t&&t[0]&&t[0].type&&9!=t[0].type&&(r[e]=i?-1:0,a.default.set("tigerIndexCache",r)),a.default.set("tigerListCache",n),f[e]=Date.now(),{list:t,index:r[e]}}).catch(function(t){console.error("请求错误: "+e+" "+(t?JSON.stringify(t):""));var n=a.default.get("tigerIndexCache");return n[e]=0,a.default.set("tigerIndexCache",n),{list:[{tiger_position_id:e}],index:n[e]}})}(e,t,r,i)});return Promise.all(l)},v=function(e,t){var n=a.default.get("tigerListCache"),i=null,r=!0,o=!1,c=void 0;try{for(var u,s=n[e][Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var d=u.value;if(d.creative_id==t){i=d;break}}}catch(e){o=!0,c=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw c}}return i};t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"sendVideoCloseLog",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.list,n=e.isEnded,i=e.timeLastShow,r=t[0].tiger_position_id,o=t[0].creative_id,a=v(r,o);s.default.sendTigerBehaviourSync("close",{list:[a],isEnded:n,timeLastShow:i})}},{key:"getTigerQrcode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.creative_id,n=e.tiger_position_id;return this.getTigerGlobalConfig().then(function(e){if(1===e.qrcodeSwitch){if(t&&n){var i=a.default.get("tigerQrcodePromise")||{},r=n+"_"+t;return i[r]||(i[r]=o.default.getTigerQrcode({creative_id:t,tiger_position_id:n}).catch(function(){return{url:null}})),a.default.set("tigerQrcodePromise",i),i[r]}return Promise.reject("[getTigerQrcode: 缺少必要参数]")}return console.error("二维码配置已关闭"),Promise.reject("二维码配置已关闭")})}},{key:"previewQrCode",value:function(e,t){e&&e.then(function(e){if(e&&e.url){var n=s.default.getStatisticSDK();wx.previewImage({urls:[e.url],success:function(){n.sendTigerBehaviourSync("qrcodeRender",{list:[t]})},fail:function(e){console.error("[navigateToTiger]: 二维码图片预览失败",e)}})}else console.warn("[navigateToTiger]: 缺少二维码图片")}).catch(function(e){console.warn("[navigateToTiger]:",e)})}},{key:"getTigerGlobalConfig",value:function(){return g||(g=o.default.getTigerGlobalConfig()),g}},{key:"navigate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.tiger_position_id,i=t.creative_id;return new Promise(function(t,o){var u=s.default.getStatisticSDK(),d=a.default.get("tigerListCache"),l=e;if(!d)return o("[navigateToTiger]: 请先获取列表");if("undefined"==n)return o("[navigateToTiger]: 请传入正确的tiger_position_id");if("undefined"==i)return o("[navigateToTiger]: 请传入正确的creative_id");var f=v(n,i);d[n];if(!f||!f.show_config)return o("[navigateToTiger]: 该参数: "+n+":"+i+", 在列表中不存在或已关闭");var g=u.packLogData().userLog.ext;g.v=c.SDK_CONFIG.SDKVERSION;var p=Object.assign({channelCode:f.channel_code},r.default.parseQuery(f.redirect_extra_data));u.sendTigerBehaviourSync("click",{list:[f]});var y=e.getTigerQrcode({creative_id:f.creative_id||"",tiger_position_id:f.tiger_position_id});function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],i=arguments[3],r=a.default.get("tigerListCache")?a.default.get("tigerListCache"):{},o=(a.default.get("tigerIndexCache")?a.default.get("tigerIndexCache"):{})[e],c=r[e]?r[e][o]:{};t.show_config&&t.show_config.is_click_change||9==t.type?l.getList({tiger_position_id_list:[e],creative_id:t.creative_id||""}).then(function(e){n(e)}).catch(function(e){i(e)}):n([h(c)])}wx.navigateToMiniProgram({appId:f.redirect_app_id,path:r.default.addQuery(f.redirect_path||"pages/index/index",p),extraData:Object.assign({tiger_info:g,tiger_list:[f],mergeAccount:{appId:c.SDK_CONFIG.APPID,openId:a.default.get("xhstat_uuid")}},p),envVersion:f&&f.redirect_version||"release",success:function(){u.sendTigerBehaviourSync("confirm",{list:[f]}),_(n,f,t,o)},fail:function(i){var r=i&&i.errMsg&&i.errMsg.indexOf("cancel")>-1;e.previewQrCode(y,f),r?u.sendTigerBehaviourSync("cancel",{list:[f]}):(u.sendTigerBehaviourSync("404",{list:[f],errMsg:JSON.stringify(i)}),console.error("跳转失败，请检查game.json(小游戏)/app.json(小程序)跳转列表是否配置正确")),_(n,f,t,o)}})})}},{key:"getList",value:function(e){var t=this,n=e.tiger_position_id_list,i=void 0===n?[]:n,o=e.appVersion,c=void 0===o?"1.0.0":o,d=e.creative_id,l=void 0===d?"":d;return i.length<=0?Promise.reject("缺少正确的tiger_position_id_list"):Promise.resolve().then(function(){return t.getTigerGlobalConfig()}).then(function(){return u.default.fetchUserInfo({openIdOnly:!0})}).then(function(e){return p(i,c,e,!1)}).then(function(e){return function(e,t){var n=a.default.get("tigerListCache"),i=[],o=[],c=[],u="",d={};return e.forEach(function(e){var r=e.list,s=e.index;if(r[0].type&&9==r[0].type){if(u=r[0].tiger_position_id,t){var l=0;r.forEach(function(e,n){e.creative_id===t&&(l=n)});var f=r.splice(l,1);r.push(f[0])}n[u]=r,a.default.set("tigerListCache",n),r.forEach(function(e,t){var n=h(e);e.render_max&&t<e.render_max&&(c.push(n),n.is_open&&o.push(e))}),d={is_open:c[0].is_open,type:c[0].type,tiger_position_id:u,list:c},i.push(d)}else{var g=0,p=!0,v=!1,y=void 0;try{for(var _,I=r[Symbol.iterator]();!(p=(_=I.next()).done);p=!0){if(_.value,s==g){var m=h(r[g]);i.push(m),m.is_open&&o.push(r[g]);break}g++}}catch(e){v=!0,y=e}finally{try{!p&&I.return&&I.return()}finally{if(v)throw y}}}}),o.length&&s.default.sendTigerBehaviourSync("render",{list:o}),r.default.deepClone(i)}(e,l)})}},{key:"sendTigerLogin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u.default.fetchUserInfo({openIdOnly:!0}).then(function(){if(e.scene=e.scene&&Number(e.scene),e.scene&&[1037,1048,1012].indexOf(e.scene)>-1){var t=e.query||{},n=r.default.parseQuery(decodeURIComponent(t.scene));if(n.qcid&&n.qpid&&[1048,1012].indexOf(e.scene)>-1){var i=[{tiger_position_id:n.qpid,creative_id:n.qcid}];s.default.sendTigerBehaviourSync("qrcodeLogin",{list:i,uid2:a.default.get("xhstat_uuid")})}else if(1037===e.scene){var o=(e.referrerInfo||{}).extraData||{},c=o.tiger_info||{},u=o.tiger_list||[];u.length&&s.default.sendTigerBehaviourSync("login",{list:u,ak:c.ak,aid:c.aid,tid:c.tid,uid:c.uid,pid:c.pid,uidfp:c.uidfp,uid2:a.default.get("xhstat_uuid")})}}})}},{key:"getTigerConfig",value:function(e){var t=e.tiger_position_id,n=void 0===t?"":t,i=e.appVersion,r=void 0===i?"1.0.0":i;return n?Promise.resolve().then(function(){return u.default.fetchUserInfo({openIdOnly:!0})}).then(function(e){return p([n],r,e,!0)}).then(function(e){return function(e){if(e&&e[0]&&e[0].list&&e[0].list[0]){var t=e[0].list[0];return{tiger_position_id:t.tiger_position_id,type:t.type,is_open:!!t.show_config}}}(e)}).catch(function(e){return console.error("请求错误: "+n+" "+(e?JSON.stringify(e):"")),{is_open:!1,tiger_position_id:n}}):Promise.reject("缺少正确的tiger_position_id")}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=(a(n(0)),a(n(2)),a(n(1)),a(n(3))),o=a(n(9));function a(e){return e&&e.__esModule?e:{default:e}}var c={},u="";t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"create",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.adUnitId;if(!n)return console.error("[createRewardedVideoAd] 缺少必要参数: adUnitId"),{};var i=function(t){if(u===n){var i=c[n].startShowTimeStamp;if(console.log("[rewardedVideoAd close]: ",t),i>0){o.default.APP_STATUS_HIDE_STAMPS.forEach(function(e,t){var n=o.default.APP_STATUS_SHOW_STAMPS[t+1];i<e&&n&&(i+=n-e)});var a=(Date.now()-i)/1e3;a=a<0?0:a>60?60:a,c[n].showVideoPromise="",r.default.sendLog("videoClose",{adUnitId:n,isEnded:t&&t.isEnded||void 0===t,timeLastShow:a})}e.showRewardedVideoAd=!1,c[n].isLoadSuccess=!1}},a=function(e){console.log("[rewardedVideoAd error]: ",e);var t=c[n];if(u===n&&(t.showVideoPromise=""),!t.isLoadSuccess||u===n){var i=t.isLoadSuccess?"videoError":"videoLoadError";console.log("[rewardedVideoAd errorType]: ",i),r.default.sendLog(i,{adUnitId:n,errMsg:JSON.stringify(e)})}},s=function(){c[n].isLoadSuccess||(console.log("[rewardedVideoAd onLoad]: ",n),c[n].isLoadSuccess=!0,r.default.sendLog("videoLoad",{adUnitId:n}))};if(!c[n]){c[n]={},c[n].video=wx.createRewardedVideoAd(t),c[n].startShowTimeStamp=0,c[n].showVideoPromise="",c[n].isLoadSuccess=!1,c[n].video.onLoad(s),c[n].video.onClose(i),c[n].video.onError(a);var d=c[n].video.offLoad.bind(c[n].video),l=c[n].video.offClose.bind(c[n].video),f=c[n].video.offError.bind(c[n].video);c[n].video.offLoad=function(e){d(e),e||c[n].video.onLoad(s)},c[n].video.offClose=function(e){l(e),e||c[n].video.onClose(i)},c[n].video.offError=function(e){f(e),e||c[n].video.onError(a)}}var g=c[n].video;return{show:function(){return n?(u=n,c[n].showVideoPromise||(c[n].showVideoPromise=g.show().then(function(e){return r.default.sendLog("videoShow",{adUnitId:n}),e})),c[n].showVideoPromise.then(function(t){return e.showRewardedVideoAd=!0,c[n].startShowTimeStamp=Date.now(),t}).catch(function(e){return a(e),Promise.reject(e)})):Promise.reject("[createRewardedVideoAd] 缺少必要参数: adUnitId")},load:function(){return g.load()},onLoad:function(e){return g.onLoad(e)},offLoad:function(e){return g.offLoad(e)},onError:function(e){return g.onError(e)},offError:function(e){return g.offError(e)},onClose:function(e){return g.onClose(e)},offClose:function(e){return g.offClose(e)}}}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.whiteDotIcon=t.videoTigerIcons=t.blinkTigerTipsIcon=t.blinkTigerCancelIcon=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(n(2)).default.RES_HOST+"/plat/SDK/sdk_img_res";t.blinkTigerCancelIcon=i+"/blink_tiger_cancel.png",t.blinkTigerTipsIcon=i+"/blink_tiger_tips.png",t.videoTigerIcons=i+"/tiger_video_icon.png",t.whiteDotIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX///+nxBvIAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg=="},,,function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=_(n(2)),o=(_(n(1)),_(n(0))),a=n(6),c=_(n(3)),u=_(n(19)),s=_(n(20)),d=_(n(8)),l=_(n(14)),f=_(n(9)),g=_(n(21)),h=_(n(22)),p=_(n(13)),v=_(n(25)),y=_(n(29));function _(e){return e&&e.__esModule?e:{default:e}}var I=function(){var e=function(e){f.default.APP_IS_SHOW=!0,f.default.APP_STATUS_SHOW_STAMPS.push(Date.now()),u.default.mergeAndSetClipBorad(e),c.default.sendStatsticLogAndInfo(e),p.default.sendTigerLogin(e),y.default.sendBackLogFromA(e)},t=function(e){f.default.fetchInitData(e)},n=function(e){console.log("appHide options: ",e),f.default.APP_IS_SHOW=!1,h.default.sendBannerBack(e),f.default.APP_STATUS_HIDE_STAMPS.push(Date.now())};return new(function(){function _(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,_),o.default.isRuningMiniGame()){if(GameGlobal.XH_SDK)return void console.error("基础SDK禁止再次初始化，请排查是否引入了多份基础SDK");GameGlobal.XH_SDK=this;var i=wx.getLaunchOptionsSync();t(i),wx.onShow(e),wx.onHide(n)}else o.default.isRuningMiniPro()&&o.default.addPreHook("App",{onLaunch:t,onShow:e,onHide:n})}return i(_,[{key:"navigateToMoreGame",value:function(){return console.error("navigateToMoreGame:此方法已停用"),Promise.resolve()}},{key:"navigateToFloatAd",value:function(){return console.error("navigateToFloatAd:此方法已停用"),Promise.resolve()}},{key:"navigateToFirstScreenAd",value:function(){return console.error("navigateToFirstScreenAd:此方法已停用"),Promise.resolve()}},{key:"getFirstScreenAd",value:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).app_version;return console.error("getFirstScreenAd： 该接口已停用"),Promise.resolve()}},{key:"getFloatAd",value:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).app_version;return console.error("getFirstScreenAd： 该接口已停用"),Promise.resolve()}},{key:"navigateToMiniProgram",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.appId,n=e.path,i=void 0===n?"pages/index/index":n,r=e.extraData,o=e.envVersion,a=void 0===o?"release":o;return f.default.navigateToMiniProgram({appId:t,path:i,extraData:r,envVersion:a})}},{key:"sendLoadingLog",value:function(e){if(o.default.isRuningMiniGame())return c.default.sendLoadingLog(e);console.error("[sendLoadingLog]: 该接口目前仅支持小游戏")}},{key:"navigateToTiger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p.default.navigate(e)}},{key:"getTigerList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p.default.getList(e)}},{key:"createTiger",value:function(e){var t=e.tiger_position_id,n=e.app_version,i=e.x,r=e.y,a=e.width,c=e.zIndex,u={};return t?n?(o.default.isRuningMiniGame()?o.default.isCocosGame()||o.default.isLayaGame()?u=new v.default(t,n,a,i,r,c):console.error("该API只支持cocos或laya引擎环境使用"):console.error("请在微信小游戏环境下使用"),u):(console.error("请传入正确的当前应用版本"),u):(console.error("请传入正确的tiger_position_id"),u)}},{key:"createBackBtn",value:function(e){var t=e.x,n=e.y,i=e.zIndex,r={};return o.default.isRuningMiniGame()?(o.default.isCocosGame()?r=y.default.create(t,n,i):console.error("该API只支持cocos引擎环境使用"),r):(console.error("请在微信小游戏环境下使用"),r)}},{key:"createRewardedVideoAd",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.default.create(e)}},{key:"onMergeAccount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.success,n=e.fail;u.default.onMergeAccount({success:t,fail:n})}},{key:"getSDKConfig",value:function(){return o.default.deepClone(a.SDK_CONFIG)}},{key:"login",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).refresh,t=void 0!==e&&e;return d.default.fetchUserInfo({openIdOnly:!t})}},{key:"updateUserInfo",value:function(e){return d.default.updateUserInfo(e)}},{key:"pay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.coin,n=e.program_param;return s.default.start({coin:t,program_param:n})}},{key:"payByCS",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.amount,n=e.program_param;return s.default.payByCS({amount:t,program_param:n})}},{key:"cancelLockPay",value:function(e){var t=e.order_code;return s.default.cancelLockPay({order_code:t})}},{key:"updateGold",value:function(e){var t=e.gold,n=e.gold_desc,i=void 0===n?"":n;return s.default.updateGold({gold:t,gold_desc:i})}},{key:"getGoldBalance",value:function(){return s.default.getGoldBalance()}},{key:"getGameSwitchConfig",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).version,t=void 0===e?"":e;return r.default.getGameSwitchConfig({version:t})}},{key:"getShareTemplates",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).version,t=void 0===e?"":e;return g.default.getShareTemplates({version:t})}},{key:"switchRequestLog",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).open;f.default.switchRequestLog({open:e})}},{key:"createBannerAd",value:function(e){return h.default.createBannerAd(e)}},{key:"getTigerConfig",value:function(e){return p.default.getTigerConfig(e)}}]),_}())}();e.exports=I},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=d(n(8)),o=d(n(3)),a=d(n(2)),c=d(n(1)),u=d(n(0)),s=n(6);function d(e){return e&&e.__esModule?e:{default:e}}var l="",f=/www\.starsriver\.cn\?([a-zA-Z0-9\-\_]+)\?([a-zA-Z0-9\-\_]+)/,g={events:[],on:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.success,n=e.fail;g.events.push({success:t,fail:n})},emitSuccess:function(e){var t=g.events;t.length&&(t.forEach(function(t){return"function"==typeof t.success&&t.success(e)}),t=[])},emitFail:function(e){var t=g.events;t.length&&(t.forEach(function(t){return"function"==typeof t.fail&&t.fail(e)}),t=[])}};function h(){"function 9 {P}function f {s}function 6 {P}function i {z}function D {o}function d {x}function h {M}function B {M}";var e=s.STORAGE_KEYS.GET_NEW_DATE_ASTRICT_KEY;return Promise.resolve().then(function(){return u.default.getStorage(e)}).then(function(n){if(n!==t())return u.default.promiseFy(wx.getClipboardData).then(function(n){var i=n.data,r=void 0===i?"":i;if(console.log(r,"原粘贴板的数据源"),r.match(f))return!1;var o=p(s.SDK_CONFIG.APPID,c.default.get("xhstat_uuid"));return o?u.default.promiseFy(wx.setClipboardData,{data:r+"\n"+o}).then(function(){return u.default.setStorage(e,t())}).then(function(){console.log(r,"粘贴成功"),wx.showLoading(),wx.hideLoading()}):void 0})});function t(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}}function p(e,t){"function i {6}function D {l}function w {Q}function 0 {3}function 9 {U}function e {h}function H {C}function Q {u}";return e&&t?"www.starsriver.cn?"+e+"?"+t:""}t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u.default.isRuningMiniPro()&&u.default.addPreHook("App",{onHide:h})}return i(e,[{key:"checkAndMergeAccount",value:function(e){"function j {V}function N {j}function R {B}function 1 {D}function 8 {5}function K {w}function l {h}function 1 {r}";var t=void 0;return Promise.resolve().then(function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Promise.resolve().then(function(){e.query=e.query||{};var t=e.query.mergeAccount;try{t=JSON.parse(t)}catch(e){t=""}return t||(t=((e.referrerInfo||{}).extraData||{}).mergeAccount||{}),t&&t.openId&&t.appId?{data:p(t.appId,t.openId)}:u.default.promiseFy(wx.getClipboardData)}).then(function(e){var t=e.data;return{match:(void 0===t?"":t).match(f)}})}(e)}).then(function(e){var n=e.match;if(n){var i=n[1],r=n[2];return console.log(n[0],"合并账户"),t=s.STORAGE_KEYS.ACCOUNT_MERGE_RECORDS_STORAGE_KEY+"_"+i+"_"+r,u.default.getStorage(t).then(function(e){if(e)return s.SDK_ERROR_CODES.NO_MERGE_ERROR;var t=n[1],i=n[2];return t!==s.SDK_CONFIG.APPID&&i!==c.default.get("xhstat_uuid")?a.default.postMergeAccounts({clipboard:"www.starsriver.cn?"+t+"?"+i}).then(function(e){return Object.assign({err:0},e)}):s.SDK_ERROR_CODES.NO_MERGE_ERROR})}return s.SDK_ERROR_CODES.NO_MERGE_ERROR}).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(0!==e.err)return g.emitFail(e),e;if(e&&e.pid){var t=c.default.get("userInfo");t=Object.assign(t,e),o.default.setUserInfoAndSendToStatistic({userInfo:t})}var n={err:e.err,message:"合并成功",data:c.default.get("userInfo")};return g.emitSuccess(n),n}).catch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e&&1031===e.err&&u.default.setStorage(t,!0);var n={err:e.err,message:e.message||e};return g.emitFail(n),n})}},{key:"mergeAndSetClipBorad",value:function(){"function c {v}function v {T}function 3 {9}function 8 {O}function e {G}function 5 {3}function 2 {h}function I {9}";var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.default.fetchUserInfo({openIdOnly:!0}).then(function(){l=e.checkAndMergeAccount(t),u.default.isRuningMiniGame()&&l.then(function(){return h()})})}},{key:"onMergeAccount",value:function(){"function d {A}function h {z}function J {s}function Y {u}function C {I}function F {T}function 7 {o}function 6 {f}";var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.success,n=e.fail;l?l.then(function(e){0===e.err?"function"==typeof t&&t(e):"function"==typeof n&&n(e)}):g.on({success:t,fail:n})}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=s(n(8)),o=n(6),a=s(n(2)),c=s(n(1)),u=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"start",value:function(){"function q {i}function 2 {G}function r {G}function l {f}function O {O}function 5 {n}function L {e}function j {w}";var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.coin,i=t.program_param;return Promise.resolve().then(function(){return r.default.fetchUserInfo({openIdOnly:!0})}).then(function(){return a.default.getCheckPayType()}).then(function(t){var r=t.pay_type;return 0===r?Promise.reject(u.default.makeResponse(o.RESPONSE.USER_PAY_DISABLED)):1===r?e.createOrderAndPayByWx({coin:n,program_param:i}):2===r?e.createOrderAndPayByMidas({coin:n,program_param:i}):void 0}).then(function(t){return e.loopCheckOrder(t)})}},{key:"loopCheckOrder",value:function(e){"function h {N}function c {s}function y {Y}function 7 {E}function J {D}function V {E}function 3 {y}function N {c}";var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.MAX_PAY_RETRY_TIMES;return Promise.resolve().then(function(){return a.default.getCheckOrderStatus(e)}).then(function(i){var r=i.pay_status;if(0===r)return 0===n?Promise.reject(u.default.makeResponse(o.RESPONSE.CHECK_ORDER_TIME_OUT)):u.default.sleep(o.PAY_RETRY_INTERVAL).then(function(){return t.loopCheckOrder(e,n-1)});if(1===r||3===r){var a=u.default.makeResponse(o.RESPONSE.PAY_SUCCESS);return a.data=a.data||{orderId:e},Promise.resolve(a)}return 2===r?Promise.reject(u.default.makeResponse(o.RESPONSE.PAY_FAIL)):void 0}).catch(function(i){return i.message===o.RESPONSE.CHECK_ORDER_TIME_OUT.message||i.message===o.RESPONSE.PAY_FAIL.message||n<=0?Promise.reject(i):u.default.sleep(o.PAY_RETRY_INTERVAL).then(function(){return t.loopCheckOrder(e,n-1)})})}},{key:"createOrderAndPayByMidas",value:function(e){"function r {s}function N {P}function 5 {O}function F {B}function O {t}function S {u}function 3 {G}function W {b}";var t=e.coin,n=e.program_param,i="";return Promise.resolve().then(function(){return u.default.promiseFy(wx.login)}).then(function(e){return a.default.platuserRefreshSession({wx_code:e.code})}).then(function(){return a.default.postCreateMidasPayOrder({coin:t,program_param:n})}).then(function(e){var t=e.item,n=t.buy_quantity;return i=t.order_code,n>0?u.default.promiseFy(wx.requestMidasPayment,{mode:t.mode,env:t.env,offerId:t.offer_id,currencyType:t.currency_type,platform:t.platform,buyQuantity:t.buy_quantity,zoneId:t.zone_id}).catch(function(e){return""===i?Promise.reject(e):a.default.putCancelPay(i).then(function(){return Promise.reject(e)}).catch(function(){return Promise.reject(e)})}).then(function(){return a.default.putConfirmPay(i)}):Promise.resolve()}).then(function(){return i}).catch(function(e){var t="";return t=u.default.isEmptyObject(e)||void 0===e?"无报错信息":e.msg||e.message||JSON.stringify(e),a.default.postPayErrorLog({order_code:i,msg:t}).then(function(){return Promise.reject(e)}).catch(function(){return Promise.reject(e)})})}},{key:"createOrderAndPayByWx",value:function(e){"function k {m}function T {c}function a {G}function x {M}function u {X}function a {h}function c {l}function K {r}";var t=e.coin,n=e.program_param,i="";return a.default.postCreateWxPayOrder({coin:t,program_param:n}).then(function(e){var t=e.item;return i=t.order_code,u.default.promiseFy(wx.requestPayment,{timeStamp:t.timestamp+"",nonceStr:t.noncestr,package:t.package,signType:t.sign_type,paySign:t.pay_sign})}).then(function(){return a.default.putConfirmPay(i)}).then(function(){return i})}},{key:"updateGold",value:function(e){"function 9 {6}function j {C}function u {w}function z {I}function 6 {9}function 8 {1}function J {p}function V {9}";var t=e.gold,n=e.gold_desc,i=void 0===n?"":n,o=t>0?0:1;return t=Math.abs(t),Promise.resolve().then(function(){return r.default.fetchUserInfo({openIdOnly:!0})}).then(function(){return a.default.putUpdateGoldBalance({gold:t,transaction_type:o,gold_desc:i})})}},{key:"cancelLockPay",value:function(e){var t=e.order_code;return t?a.default.putCancelPay(t):Promise.reject("请使用正确的订单号")}},{key:"getGoldBalance",value:function(){"function C {i}function 2 {j}function 7 {G}function c {b}function n {S}function o {P}function p {J}function m {M}";return Promise.resolve().then(function(){return r.default.fetchUserInfo({openIdOnly:!0})}).then(a.default.getGoldBalance)}},{key:"payByCS",value:function(e){"function B {W}function I {9}function 0 {H}function 8 {g}function 4 {5}function U {q}function x {A}function H {V}";var t=this,n=e.amount,i=e.program_param;return u.default.isRuningMiniGame()?"number"!=typeof n?Promise.reject("金额必须是数字类型"):n<.1?Promise.reject("amount参数不能小于0.1"):""===i||"string"!=typeof i?Promise.reject("program_param不能为空且必须为字符类型"):Promise.resolve().then(function(){return a.default.postCreateH5PayOrder({amount:n,program_param:i})}).then(function(e){var r=e.order_id,a=c.default.get("xhstat_access_token")||"",u=c.default.get("xhstat_uuid");if(!a)return Promise.reject("[payByCs] from_access_token不能为空");if(!u)return Promise.reject("[payByCs] from_uid不能为空");var s=JSON.stringify({from_appid:o.SDK_CONFIG.APPID,from_pgid:o.SDK_CONFIG.PROGRAM_ID,from_uid:u,amount:n,program_param:i,from_access_token:a,order_id:r});return console.log(s),t.H5PayOpenCS(s,r)}):u.default.isRuningMiniPro()?Promise.reject("小程序环境暂不支持H5支付功能"):Promise.reject("当前环境不属于小游戏或小程序，不支持H5支付功能")}},{key:"H5PayOpenCS",value:function(e,t){var n=this;return new Promise(function(i,r){var o=!1;u.default.promiseFy(wx.openCustomerServiceConversation,{sessionFrom:e}).catch(function(e){var t=e;return t.message,o=!0,r(t)}),u.default.nextShow().then(function(){if(!o)return n.loopCheckH5Order(t).then(i).catch(r)})})}},{key:"checkH5PayOrderStatus",value:function(e){return-2===e?Promise.reject({message:u.default.makeResponse(o.RESPONSE.H5PAY_FAIL_SELLER_DELIVER_FAIL).message}):-1===e?Promise.reject({message:u.default.makeResponse(o.RESPONSE.H5PAY_FAIL_PAY_ERROR).message}):0===e?Promise.reject({message:u.default.makeResponse(o.RESPONSE.H5PAY_FAIL_BUYER_NOT_PAY).message}):1===e?Promise.reject({message:u.default.makeResponse(o.RESPONSE.H5PAY_FAIL_SELL_NOT_DELIVERY).message}):2===e?Promise.resolve(u.default.makeResponse(o.RESPONSE.PAY_SUCCESS)):Promise.reject({message:u.default.makeResponse(o.RESPONSE.CHECK_ORDER_TIME_OUT).message})}},{key:"loopCheckH5Order",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.MAX_PAY_RETRY_TIMES,i=function(e,n,i){return n<=1?t.checkH5PayOrderStatus(i):u.default.sleep(o.PAY_RETRY_INTERVAL).then(function(){return t.loopCheckH5Order(e,n-1)})};return Promise.resolve().then(function(){return a.default.getH5PayOrderStatus(e)}).then(function(t){var r=t.order_status;return 2===r?u.default.makeResponse(o.RESPONSE.PAY_SUCCESS):i(e,n,r)}).catch(function(t){return[o.RESPONSE.H5PAY_FAIL_SELLER_DELIVER_FAIL.message,o.RESPONSE.H5PAY_FAIL_PAY_ERROR.message,o.RESPONSE.H5PAY_FAIL_BUYER_NOT_PAY.message,o.RESPONSE.H5PAY_FAIL_SELL_NOT_DELIVERY.message,o.RESPONSE.CHECK_ORDER_TIME_OUT.messageT].indexOf(t.message)>-1?Promise.reject(t):i(e,n)})}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(i=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&c.return&&c.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=c(n(2)),a=(c(n(1)),c(n(0)),c(n(3)));function c(e){return e&&e.__esModule?e:{default:e}}t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getShareCallBackConfigs",value:function(e){return o.default.shareCallbackConfigs({version:e}).catch(function(){return""})}},{key:"getShareTemplates",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).version;return Promise.all([this.getShareCallBackConfigs(e),o.default.getShareTemplate({version:e})]).then(function(e){var t=i(e,2),n=t[0],r=t[1];return n&&a.default.sendShareCallBackConfig(n),r}).catch(function(){return[]})}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=(a(n(0)),a(n(2)),a(n(1)),a(n(3))),o=a(n(14));a(n(9));function a(e){return e&&e.__esModule?e:{default:e}}var c="",u={};t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"createBannerAd",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.adUnitId,n=wx.createBannerAd(e),i=!1;u[t]={};var o=function(){console.log("[wxBanner onLoad]"),i=!0,r.default.sendLog("bannerLoad",{adUnitId:t})},a=function(e){console.log("[wxBanner error]: ",e);var n=i?"bannerShowError":"bannerLoadError";console.log("[wxBanner errorType]: ",n);var o={adUnitId:t,errMsg:JSON.stringify(e)};void 0!==e.errCode&&(o.errCode=e.errCode),r.default.sendLog(n,o)};n.onLoad(o),n.onError(a);var s=n.offLoad.bind(n),d=n.offError.bind(n);return n.offLoad=function(e){s(e),e||n.onLoad(o)},n.offError=function(e){d(e),e||n.onError(a)},{style:n&&n.style,show:function(){return c=t,u[t].showPromise||(u[t].showPromise=n.show().then(function(e){return r.default.sendLog("bannerShow",{adUnitId:t}),e})),u[t].showPromise},destroy:function(){return c="",u[t].showPromise="",i=!1,n.destroy()},hide:function(){return c="",u[t].showPromise="",i=!1,n.hide()},onResize:function(e){return n.onResize(e)},offResize:function(e){return n.offResize(e)},onLoad:function(e){return n.onLoad(e)},offLoad:function(e){return n.offLoad(e)},onError:function(e){return n.onError(e)},offError:function(e){return n.offError(e)}}}},{key:"sendBannerBack",value:function(e){if(c&&e.targetPagePath&&(e.targetPagePath.toLowerCase().indexOf("nativelandingpages")>-1||e.targetPagePath.indexOf("http")>-1)&&!o.default.showRewardedVideoAd){var t=r.default.getStatisticSDK();t.sendLog&&t.sendLog("bannerBack",{adUnitId:c})}}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(7);!function(e){e&&e.__esModule}(n(0));var o={},a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"show",value:function(e,t,n){switch(this.clearActions(e,n),t){case r.AdvDynamicType.easeInOut:this.runRepeatedScaleAnimation(e);break;case r.AdvDynamicType.shake:this.runRepeatedShakeAnimation(e);break;case r.AdvDynamicType.moveByY:this.runRepeatedMoveByYAnimation(e)}}},{key:"enter",value:function(e,t,n){switch(t){case r.AdvEnterAnimationType.showToTop:return this.runEnterSlideToTopAnimation(e,n);case r.AdvEnterAnimationType.jumpFromTop:return this.runEnterJumpFromTopAnimation(e,n);default:return Promise.resolve()}}},{key:"exit",value:function(e,t,n){switch(this.clearActions(e,n),t){case r.exitAnimationType.exitToBottom:return this.runExitSlideToBottomAnimation(e,n);default:return Promise.resolve()}}},{key:"clearActions",value:function(e,t){cc.isValid(e)&&(e.stopAllActions(),t&&void 0!==t.x&&void 0!==!t.y&&e.runAction(cc.place(cc.p(t.x,t.y))))}},{key:"runRepeatedMoveByYAnimation",value:function(e){if(cc.isValid(e)){e.runAction(cc.repeatForever(cc.sequence(cc.moveBy(.5,cc.p(0,40)).easing(cc.easeCubicActionOut()),cc.moveBy(.1,cc.p(0,-40)),cc.moveBy(.5,cc.p(0,20)).easing(cc.easeCubicActionOut()),cc.moveBy(.1,cc.p(0,-20)),cc.moveBy(.1*3,cc.p(0,10)).easing(cc.easeCubicActionOut()),cc.moveBy(.1,cc.p(0,-10)),cc.delayTime(1))))}}},{key:"runRepeatedShakeAnimation",value:function(e){if(cc.isValid(e)){e.runAction(cc.repeatForever(cc.sequence(cc.moveBy(.02,cc.p(10,0)),cc.moveBy(.04,cc.p(-20)),cc.moveBy(.02,cc.p(10)),cc.moveBy(.02,cc.p(0,10)),cc.moveBy(.04,cc.p(0,-20)),cc.moveBy(.02,cc.p(0,10)),cc.moveBy(.02,cc.p(5,0)),cc.moveBy(.04,cc.p(-10,0)),cc.moveBy(.02,cc.p(5,0)),cc.moveBy(.02,cc.p(0,5)),cc.moveBy(.04,cc.p(0,-10)),cc.moveBy(.02,cc.p(0,5)),cc.delayTime(1))))}}},{key:"runRepeatedScaleAnimation",value:function(e){if(cc.isValid(e)){e.scale=1;var t=cc.scaleTo(.3,1.2),n=cc.scaleTo(.3,1),i=cc.sequence(cc.repeat(cc.sequence(t,n),2),cc.delayTime(.5)),r=cc.repeatForever(i);e.runAction(r)}}},{key:"runEnterJumpFromTopAnimation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,i){if(cc.isValid(e)){var o=t.x||e.x,a=t.y||e.y,c=r.tigerUIApi.getWinSize().height+e.height;e.runAction(cc.sequence(cc.place(cc.p(o,c)),cc.moveTo(.2*3,cc.p(o,a-40)).easing(cc.easeSineIn()),cc.moveTo(.4,cc.p(o,a+10)).easing(cc.easeCircleActionOut()),cc.moveTo(.4,cc.p(o,a-5)).easing(cc.easeSineIn()),cc.moveTo(.2,cc.p(o,a)).easing(cc.easeCircleActionOut()),cc.callFunc(function(){n()})))}else n()})}},{key:"runEnterSlideToTopAnimation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,i){if(cc.isValid(e)){var a=t.x||e.x,c=t.y||e.y,u=r.tigerUIApi.getWinSize(),s=o.systemInfo||wx.getSystemInfoSync(),d=o.winSizeHeight||Math.max(s.windowHeight,u.height);o.winSizeHeight=d,o.systemInfo=s,e.runAction(cc.sequence(cc.place(cc.p(a,-d)),cc.moveTo(.6,cc.p(a,c)).easing(cc.easeSineIn()),cc.callFunc(function(){n()})))}})}},{key:"runExitSlideToBottomAnimation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,i){if(cc.isValid(e)){var a=t.x||e.x,c=t.y||e.y,u=o.systemInfo||wx.getSystemInfoSync(),s=r.tigerUIApi.getWinSize(),d=o.winSizeHeight||Math.max(u.windowHeight,s.height);o.winSizeHeight=d,o.systemInfo=u,e.runAction(cc.sequence(cc.place(cc.p(a,c)),cc.moveTo(.6,cc.p(a,-d)).easing(cc.easeSineIn()),cc.callFunc(function(){n()})))}})}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(7);var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"show",value:function(e,t){t==r.AdvDynamicType.EaseInOut?this.scale(e):t==r.AdvDynamicType.Shake?this.shake(e):Laya.timer.clearAll(e)}},{key:"shake",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:500,o=e.x,a=e.y,c=Laya.timer.currTimer;e.handler_shake=e.handler_shake||function(){var e=Laya.timer.currFrame,u=Laya.timer.currTimer,s=u-c;s>i?s>i+r?c=u:(this.x=o,this.y=a):(this.x+=Math.sin(e)*t,this.y-=Math.cos(e)*n)},Laya.timer.clearAll(e),Laya.timer.frameLoop(2,e,e.handler_shake)}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1.2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,r=e.scaleX,o=e.scaleY,a=e.width,c=e.height,u=e.x,s=e.y;e.handler_scale=e.handler_scale||function(){Laya.Tween.to(e,{x:u-(t*a-a)/2,y:s-(n*c-c)/2,scaleX:t,scaleY:n},500,Laya.Ease.quadOut,Laya.Handler.create(e,function(){Laya.Tween.to(e,{x:u,y:s,scaleX:r,scaleY:o},250)}))},Laya.timer.clearAll(e),Laya.timer.frameLoop(i,e,e.handler_scale)}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(i=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&c.return&&c.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=g(n(13)),a=g(n(0)),c=g(n(9)),u=n(7),s=n(15),d=g(n(26)),l=g(n(27)),f=g(n(28));function g(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=this,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:u.DEFAULT_NODE_INDEX;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),console.log("[createTiger] 渲染，",t,n,r,c,g,h),this[u.tigerUIConfig]={},o.default.getTigerConfig({tiger_position_id:t,appVersion:n}).then(function(e){e.is_open?[u.tigerUIType.recommend,u.tigerUIType.fakeVideo,u.tigerUIType.staticIcon,u.tigerUIType.dynamicIcon,u.tigerUIType.blinkIcon,u.tigerUIType.horizontalBlinkIcon].includes(e.type)?o.default.getList({tiger_position_id_list:[t],appVersion:n}).then(function(e){var o=i(e,1)[0];if(u.tigerUIApi.sceneIsInit())if(u.tigerUIApi.getSceneChildByName("tiger_"+t))s[u.runCallBack]("onErrorCallBacks",{message:"[createTiger] 创建错误: 该"+t+"节点已存在"});else{if(s[u.tigerUIConfig]=Object.assign(s[u.tigerUIConfig],{tigerConfig:o,appVersion:n,tiger_position_id:t}),u.tigerUIType.fakeVideo===o.type){if(!a.default.isCocosGame())return void s[u.runCallBack]("onErrorCallBacks",{message:"[createTiger]: 该类型暂不支持该引擎渲染"});s[u.tigerUIConfig].tigerVideo=new l.default(s[u.tigerUIConfig]),s[u.tigerUIConfig].tigerVideo.onClose(function(e){s[u.runCallBack]("onCloseCallBacks",Object.assign({message:"[createTiger] 组件节点已关闭"},e))})}else if(u.tigerUIType.recommend===o.type){if(!a.default.isCocosGame())return void s[u.runCallBack]("onErrorCallBacks",{message:"[createTiger]: 该类型暂不支持该引擎渲染"});s[u.tigerUIConfig].tigerRecommend=new f.default(s[u.tigerUIConfig],c,g)}else s[u.initTigerNode](o,c,g,r,h),s[u.renderTiger](),s[u.tigerTapEvent]();s[u.runCallBack]("onRenderCallBacks",{message:"[createTiger] 组件节点已渲染"}),-1==[u.tigerUIType.fakeVideo,u.tigerUIType.blinkIcon,u.tigerUIType.horizontalBlinkIcon].indexOf(o.type)&&o.show_config&&!o.show_config.auto_change&&d.default.add(s)}else s[u.runCallBack]("onErrorCallBacks",{message:"[createTiger] 场景未渲染完成，创建失败"})}).catch(function(e){s[u.runCallBack]("onErrorCallBacks",{message:e})}):s[u.runCallBack]("onErrorCallBacks",{message:"[createTiger]: 暂不支持该tiger类型渲染"}):s[u.runCallBack]("onErrorCallBacks",{message:"[createTiger] 创建错误: 远端配置未开启"})}).catch(function(e){s[u.runCallBack]("onErrorCallBacks",{message:e})})}return r(e,[{key:u.initTigerNode,value:function(e,t,n,i,r){var o=u.tigerUIApi.getWinSize(),a=o.width>o.height,c=o.width/u.standardCanvasSize[a?"landscape":"portrait"].width;[u.tigerUIType.blinkIcon,u.tigerUIType.horizontalBlinkIcon].indexOf(e.type)>-1?this[u.initBlinkTigerNode](e,o,r,c):this[u.initIconTigerNode](e,t,n,i,r,c),this[u.tigerUIConfig].sceneId=u.tigerUIApi.getSceneId()}},{key:u.initIconTigerNode,value:function(e,t,n,i,r,o){var a=(0,u.getTigerStyle)()[e.type],c=i<100?100:i>a.w?a.w:i;if(c){var s=a.w/a.h;a.w=c,a.h=c/s}a.w*=o,a.h*=o;var d=u.tigerUIApi.createNode("tiger_"+e.tiger_position_id,{style:{x:t,y:n,width:a.w,height:a.h,zIndex:r}});u.tigerUIApi.setNodeClickScaleTransition(d,{duration:.2,scale:1.1}),this[u.tigerUIConfig].displayNode=d;var l=u.tigerUIApi.getStylePosition(d,{width:a.w,height:a.h,x:t,y:n});this[u.tigerUIConfig].customConfig={isAlreadyShowEnterAnimation:!1,zIndex:r,width:i,x:l.x,y:l.y,orginX:t,orginY:n}}},{key:u.initBlinkTigerNode,value:function(e,t,n,i){var r=(0,u.getTigerStyle)()[e.type],o=180*i,a=90*i,c=n===u.DEFAULT_NODE_INDEX?n+1:n,s=u.tigerUIApi.createNode("tiger_"+e.tiger_position_id,{style:{x:0,y:0,width:r.w,height:r.h,zIndex:c}}),d=u.tigerUIApi.createNode("tiger_"+e.tiger_position_id+"_blink_tips",{style:{x:0,y:0,width:o,height:a,zIndex:c+1}}),l=u.tigerUIApi.createNode("tiger_"+e.tiger_position_id+"_blink_cancel",{style:{x:t.width-o-10*i,y:t.height-a-10*i,width:o,height:a,zIndex:c+1}});this[u.tigerUIConfig].blinkCancelNode=l,this[u.tigerUIConfig].blinkAdTipsNode=d,this[u.tigerUIConfig].displayNode=s}},{key:u.renderTiger,value:function(){var e=this,t=this[u.tigerUIConfig],n=t.displayNode,i=t.tigerConfig,r=t.customConfig;if(n){var o=(0,u.getConfigImages)(i);this[u.tigerUIConfig].imageIsLoading=!0,u.tigerUIApi.loadImage(n,o[0]).then(function(){e[u.tigerUIConfig].imageIsLoading=!1,[u.tigerUIType.dynamicIcon,u.tigerUIType.staticIcon].indexOf(i.type)>-1&&e[u.checkIsRunEnterSceneAction]().then(function(){u.tigerUIApi.runAction(n,i.show_config.show_type,{x:r.x,y:r.y}),e[u.startAutoSwitch]()}),i.type===u.tigerUIType.dynamicIcon&&e[u.fpsIconLooper](o),[u.tigerUIType.blinkIcon,u.tigerUIType.horizontalBlinkIcon].indexOf(i.type)>-1&&e[u.loadBlinkIcon]().then(function(){setTimeout(function(){e.destroy({from:"firstScreenFinish"})},1e3*i.show_config.duration)}).catch(function(){console.error("[createTiger]: 闪屏图片资源渲染失败"),e.destroy({from:"firstScreenFinish"})})}).catch(function(t){[u.tigerUIType.blinkIcon,u.tigerUIType.horizontalBlinkIcon].indexOf(i.type)>-1&&(console.error("[createTiger]: 闪屏图片主图资源渲染失败"),e.destroy({from:"firstScreenFinish"}))})}}},{key:u.checkIsRunEnterSceneAction,value:function(){var e=this,t=this[u.tigerUIConfig],n=t.displayNode,i=t.tigerConfig,r=t.customConfig;return new Promise(function(t,o){if(r.isAlreadyShowEnterAnimation)return t();var a=i.position_show_type;u.tigerUIApi.runEnterSceneAction(n,a,{x:r.x,y:r.y}).then(function(){e[u.tigerUIConfig].customConfig.isAlreadyShowEnterAnimation=!0,t()})})}},{key:u.loadBlinkIcon,value:function(){var e=this[u.tigerUIConfig],t=e.blinkAdTipsNode,n=e.blinkCancelNode;e.tigerConfig;return Promise.all([t&&u.tigerUIApi.loadImage(t,s.blinkTigerTipsIcon),n&&u.tigerUIApi.loadImage(n,s.blinkTigerCancelIcon)])}},{key:u.fpsIconLooper,value:function(e){var t=this,n=1;!function e(i){clearTimeout(t[u.tigerUIConfig].scheduleFpsTimer),t[u.tigerUIConfig].scheduleFpsTimer=setTimeout(function(){var r=t[u.tigerUIConfig],o=r.displayNode,a=r.sceneId,c=r.tigerConfig;c.is_open&&c.show_config.fps>0&&u.tigerUIApi.isNowScene(a)&&u.tigerUIApi.isVisible(o)&&!u.tigerUIApi.isDestroy(o)&&(n>=i.length&&(n=0),u.tigerUIApi.loadImage(o,i[n]).then(function(){n+=1,e(i)}))},1/t[u.tigerUIConfig].tigerConfig.show_config.fps*1e3)}(e)}},{key:u.tigerTapEvent,value:function(){var e=this,t=this[u.tigerUIConfig],n=t.displayNode,i=t.blinkCancelNode;n&&u.tigerUIApi.bindTap({node:n,type:"touch",callback:function(){var t=e[u.tigerUIConfig].tigerConfig;e[u.tigerUIConfig].imageIsLoading||o.default.navigate({tiger_position_id:t.tiger_position_id,creative_id:t.creative_id}).then(function(n){e[u.tigerUIConfig].tigerConfig.creative_id!==n[0].creative_id&&-1==[u.tigerUIType.blinkIcon,u.tigerUIType.horizontalBlinkIcon].indexOf(t.type)&&(e[u.tigerUIConfig].tigerConfig=n[0],e[u.renderTiger]())})}}),i&&u.tigerUIApi.bindTap({node:i,type:"touch",callback:function(){e.destroy({from:"skipByButton"})}})}},{key:u.startAutoSwitch,value:function(){var e=this,t=Date.now();clearTimeout(this[u.tigerUIConfig].autoSwitchTimer),this[u.tigerUIConfig].autoSwitchTimer=setTimeout(function(){var n=e[u.tigerUIConfig],i=(n.tiger_position_id,n.appVersion,n.displayNode,n.tigerConfig),r=c.default.APP_STATUS_SHOW_STAMPS[c.default.APP_STATUS_SHOW_STAMPS.length-1];t<r?e[u.startAutoSwitch]():i.show_config&&i.show_config.auto_change>0&&e[u.reRenderTigerToView]()},1e3*this[u.tigerUIConfig].tigerConfig.show_config.auto_change)}},{key:u.reRenderTigerToView,value:function(){var e=this,t=this[u.tigerUIConfig],n=t.tiger_position_id,i=t.sceneId,r=t.appVersion,a=t.displayNode;t.tigerConfig;u.tigerUIApi.isNowScene(i)&&u.tigerUIApi.isVisible(a)&&!u.tigerUIApi.isDestroy(a)?o.default.getList({tiger_position_id_list:[n],appVersion:r}).then(function(t){e[u.tigerUIConfig].tigerConfig=t[0],e[u.renderTiger]()}):this.destroy({from:"remoteConfigOff"})}},{key:u.runCallBack,value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e?("onErrorCallBacks"===e&&console.error(t.message),(this[u.tigerUIConfig][e]||[]).forEach(function(e){return"Function"===a.default.getVariableType(e)&&e(t)})):console.error("请传入正确的回调类型")}},{key:u.addCallBack,value:function(e,t){if(e)if("Function"===a.default.getVariableType(t)){var n=this[u.tigerUIConfig][e]||[];n.push(t),this[u.tigerUIConfig][e]=n}else console.error("至少传入一个回调函数");else console.error("请传入正确的回调类型")}},{key:u.deleteCallBack,value:function(e,t){if(e){var n=this[u.tigerUIConfig][e]||[];n=t?n.filter(function(e){return e!==t}):[],this[u.tigerUIConfig][e]=n}else console.error("请传入正确的回调类型")}},{key:"onRender",value:function(e){this[u.addCallBack]("onRenderCallBacks",e)}},{key:"offRender",value:function(e){this[u.deleteCallBack]("onRenderCallBacks",e)}},{key:"onError",value:function(e){this[u.addCallBack]("onErrorCallBacks",e)}},{key:"offError",value:function(e){this[u.deleteCallBack]("onErrorCallBacks",e)}},{key:"onDestroy",value:function(e){this[u.addCallBack]("onDestroyCallBacks",e)}},{key:"offDestroy",value:function(e){this[u.deleteCallBack]("onDestroyCallBacks",e)}},{key:"onClose",value:function(e){this[u.addCallBack]("onCloseCallBacks",e)}},{key:"offClose",value:function(e){this[u.deleteCallBack]("onCloseCallBacks",e)}},{key:"destroy",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).from,t=void 0===e?"customTrigger":e;if(this[u.tigerUIConfig].tigerRecommend)this[u.runCallBack]("onDestroyCallBacks",{from:t,message:"[createTiger] 组件销毁成功"}),this[u.tigerUIConfig].tigerRecommend.destroy(),delete this[u.tigerUIConfig].tigerRecommend;else{var n=this[u.tigerUIConfig],i=(n.type,n.tiger_position_id),r=n.displayNode,o=n.blinkAdTipsNode,a=n.blinkCancelNode,c=n.scheduleFpsTimer,s=n.autoSwitchTimer;if(a&&!u.tigerUIApi.isDestroy(a)&&a.destroy(),o&&!u.tigerUIApi.isDestroy(o)&&o.destroy(),r&&!u.tigerUIApi.isDestroy(r))return clearTimeout(c),clearTimeout(s),d.default.clear(i),this[u.runCallBack]("onDestroyCallBacks",{from:t,message:"[createTiger] 组件销毁成功"}),console.log("[createTiger] tiger已销毁",i),r.destroy()}}}]),e}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(7);t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ALL_TIGER_UI_LIST=[],this.hasInitReGetTigerTimer=!1}return i(e,[{key:"add",value:function(e){this.ALL_TIGER_UI_LIST.push(e),this.init()}},{key:"init",value:function(){var e=this;this.hasInitReGetTigerTimer||(this.hasInitReGetTigerTimer=setInterval(function(){e.ALL_TIGER_UI_LIST.forEach(function(e){console.log("[refreshTigerUITimer] UI刷新"),e[r.reRenderTigerToView]&&e[r.reRenderTigerToView]()})},r.PRE_TIGER_REFRESH))}},{key:"clear",value:function(e){this.ALL_TIGER_UI_LIST=this.ALL_TIGER_UI_LIST.filter(function(t){return t[r.tigerUIConfig].tiger_position_id!==e}),0==this.ALL_TIGER_UI_LIST.length&&this.stop()}},{key:"stop",value:function(){clearInterval(this.hasInitReGetTigerTimer),this.ALL_TIGER_UI_LIST=[],this.hasInitReGetTigerTimer=!1}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tigerVideoUIImagePosition=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(7),o=n(15),a=u(n(0)),c=u(n(13));u(n(3));function u(e){return e&&e.__esModule?e:{default:e}}var s=t.tigerVideoUIImagePosition={closeBtnWithLine:{rectX:0,rectY:18,rectW:122,rectH:45},closeBtn:{rectX:0,rectY:180,rectW:122,rectH:66},viewBtn:{rectX:0,rectY:100,rectW:120,rectH:60},soundBtnOpened:{rectX:140,rectY:0,rectW:82,rectH:71},soundBtnClose:{rectX:140,rectY:100,rectW:82,rectH:71},videoBtn:{rectX:140,rectY:180,rectW:119,rectH:119}},d={},l=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=n.tigerConfig||{};this.tigerConfig=i,this.tiger_position_id=i.tiger_position_id,this.creative_id=i.creative_id,this.tigerVideoConfigs=i.show_config,this.winSize=r.tigerUIApi.getWinSize(),this.renderVideoWrapperNode(),this.videoCloseCallBacks=[],this.isEnded=!1,this.runingSecondTotal=0,r.tigerUIApi.runEnterSceneAction(this.videoWrapperNode,r.AdvEnterAnimationType.showToTop).then(function(){t.renderVideoCloseButton(),t.renderBanner(),t.tigerVideoConfigs.audio&&t.renderSound(),t.renderVideo(),t.bindAppShowOrHide()})}return i(e,[{key:"bindAppShowOrHide",value:function(){var e=this;this.onHideStopVideoFn=function(){e.pauseVideo()},this.onShowPlayVideoFn=function(){e.continueVideo()},wx.onHide(this.onHideStopVideoFn),wx.onShow(this.onShowPlayVideoFn)}},{key:"bindOffHideStopVideo",value:function(){this.onHideStopVideoFn&&wx.offHide(this.onHideStopVideoFn),this.onShowPlayVideoFn&&wx.offShow(this.onShowPlayVideoFn)}},{key:"unzipVideoImages",value:function(){var e=this.tigerVideoConfigs,t=this.tiger_position_id+"_"+this.creative_id,n=e.video;return d[n]?d[n]:d[n]=Promise.resolve().then(function(){return a.default.promiseFy(wx.downloadFile,{url:e.video})}).then(function(e){if(200!==e.statusCode)return console.error("[tigerVideo] 资源包下载失败"),Promise.resolve([]);var n=wx.getFileSystemManager(),i=wx.env.USER_DATA_PATH+"/video_image_"+t+"/",r=["jpeg","jpg","png"];return a.default.promiseFy(n.access,{path:i}).then(function(e){return a.default.promiseFy(n.rmdir,{dirPath:i,recursive:!0}).then(function(){return Promise.resolve()})}).catch(function(){return Promise.resolve()}).then(function(){return a.default.promiseFy(n.unzip,{zipFilePath:e.tempFilePath,targetPath:i})}).then(function(){return a.default.promiseFy(n.readdir,{dirPath:i})}).then(function(e){var t=[];return e.files.forEach(function(e,n){var o=e.split(".").pop();if(r.includes(o)){var a=Number(e.replace(/[^0-9]/g,""));t[a]=i+e}}),t})})}},{key:"onClose",value:function(e){"Function"===a.default.getVariableType(e)&&this.videoCloseCallBacks.push(e)}},{key:"offClose",value:function(e){e?"Function"===a.default.getVariableType(e)&&(this.videoCloseCallBacks=this.videoCloseCallBacks.filter(function(t){return t!==e})):this.videoCloseCallBacks=[]}},{key:"renderVideoWrapperNode",value:function(){var e=this.winSize,t=r.tigerUIApi.createNode("videoWrapperNode",{style:{zIndex:2*r.DEFAULT_NODE_INDEX}}),n=r.tigerUIApi.createNode("videoBgNode",{parent:t,style:{x:0,y:0,width:r.tigerUIApi.scaleSizeInCanvas(e.width),height:r.tigerUIApi.scaleSizeInCanvas(e.height),bgColor:"0,0,0",zIndex:t.zIndex+1}});r.tigerUIApi.bindTap({node:n,type:"touch"}),this.videoWrapperNode=t,this.videoBgNode=n}},{key:"destroy",value:function(){var e=this;r.tigerUIApi.runExitSceneAction(this.videoWrapperNode,r.exitAnimationType.exitToBottom).then(function(){e.videoWrapperNode.destroy(),e.bindOffHideStopVideo();var t={isEnded:e.isEnded,runingSecondTotal:Number(e.runingSecondTotal.toFixed(2))};c.default.sendVideoCloseLog({list:[e.tigerConfig],isEnded:t.isEnded,timeLastShow:t.runingSecondTotal}),e.videoCloseCallBacks.forEach(function(e){return e(t)}),console.log("[tigerVideo close]",t)})}},{key:"renderVideo",value:function(){var e=this,t=this.videoWrapperNode,n=(this.tigerVideoConfigs,this.winSize),i=r.tigerUIApi.createNode("videoNode",{parent:t,style:{x:0,y:n.height/2-n.width/(16/9)/2,width:n.width,height:n.width/(16/9),zIndex:t.zIndex+1}}),a=r.tigerUIApi.scaleSizeInCanvas(80),c=r.tigerUIApi.createNode("videoRePlayIconNode",{parent:t,style:{x:n.width/2-a/2,y:n.height/2-a/2,width:a,height:a,zIndex:t.zIndex+1}});this.showRePlayNode=function(){e.videoRePlayIconNode.active=!0,r.tigerUIApi.loadImage(c,o.videoTigerIcons,s.videoBtn)},this.hideRePlayNode=function(){e.videoRePlayIconNode.active=!1},this.videoRePlayIconNode=c,this.videoNode=i,this.playVideo(),r.tigerUIApi.bindTap({node:i,type:"touch",callback:function(){e.isStopVideo&&e.playVideo()}})}},{key:"checkIsPauseVideo",value:function(){var e=this;return new Promise(function(t){e.isPauseVideo?e.checkIsPauseVideoCallBack=function(){t()}:t()})}},{key:"continueVideo",value:function(){this.isShowCloseModal||this.isShowNavigatorModal||(this.checkIsPauseVideoCallBack&&this.checkIsPauseVideoCallBack(),this.hideRePlayNode(),this.openSound&&this.openSound(),this.isPauseVideo=!1)}},{key:"pauseVideo",value:function(){this.isPauseVideo=!0,this.showRePlayNode(),this.closeSound&&this.closeSound()}},{key:"stopVideo",value:function(){this.showRePlayNode(),this.closeSound&&this.closeSound(),this.isStopVideo=!0,this.setRemainSecondText(0)}},{key:"playVideo",value:function(){var e=this,t=this.videoNode,n=this.tigerVideoConfigs,i=n.fps,o=0,a=n.images_num,c=a/i;this.isStopVideo=!1,this.nowVideoPlayTimePosition=0,this.hideRePlayNode(),this.setRemainSecondText(c),n.cover&&r.tigerUIApi.loadImage(t,n.cover),this.unzipVideoImages().then(function(u){n.cover=n.cover||u[0],e.openSound&&e.openSound();!function s(){var d=(o+1)/i;e.nowVideoPlayTimePosition=d,o<u.length&&!e.isStopVideo?(d===Math.floor(d)&&e.setRemainSecondText(c-d),r.tigerUIApi.loadImage(t,u[o]).then(function(){e.runingSecondTotal+=c/a,o+=1,setTimeout(function(){e.checkIsPauseVideo().then(function(){s()})},c/a*1e3)})):(n.cover&&r.tigerUIApi.loadImage(t,n.cover),e.stopVideo())}()})}},{key:"renderVideoCloseButton",value:function(){var e=this,t=this.videoWrapperNode,n=this.winSize,i=this,c=a.default.isHighViewPhone(n),u=r.tigerUIApi.scaleSizeInCanvas(80),d=r.tigerUIApi.scaleSizeInCanvas(30),l=r.tigerUIApi.createNode("videoCloseNode",{parent:t,style:{width:u,height:d,x:r.tigerUIApi.scaleSizeInCanvas(18),y:r.tigerUIApi.scaleSizeInCanvas(14+(c?40:0)),zIndex:t.zIndex+1}}),f=r.tigerUIApi.createLabelNode("videoCloseLabelNode",{parent:t,style:{width:u,height:d,x:r.tigerUIApi.scaleSizeInCanvas(23),y:r.tigerUIApi.scaleSizeInCanvas(19+(c?40:0)),zIndex:t.zIndex+1,fontStyle:{string:"退出",fontSize:r.tigerUIApi.scaleSizeInCanvas(15),overflow:"CLAMP",color:"255,255,255,255"}}});this.setRemainSecondText=function(t){e.isEnded||(t=Math.ceil(t),r.tigerUIApi.setStyle(f,{fontStyle:{string:"退出    "+(t>0?t+"秒":"")}}),0===t?(e.isEnded=!0,e.videoIsEnded()):e.isEnded=!1)},r.tigerUIApi.bindTap({node:l,type:"touch",callback:function(){e.pauseVideo(),e.isEnded?i.destroy():(e.isShowCloseModal=!0,wx.showModal({title:"提示",content:"观看完整视频可获得游戏奖励",cancelText:"关闭广告",confirmText:"继续观看",success:function(e){i.isShowCloseModal=!1,e.cancel?i.destroy():i.continueVideo()}}))}});var g={width:r.tigerUIApi.scaleSizeInCanvas(90),height:r.tigerUIApi.scaleSizeInCanvas(35),x:r.tigerUIApi.scaleSizeInCanvas(14),y:r.tigerUIApi.scaleSizeInCanvas(10)+r.tigerUIApi.scaleSizeInCanvas(c?40:0)},h=r.tigerUIApi.createNode("videoCloseBorderNode",{parent:t,style:{width:g.width,height:g.height,x:g.x,y:g.y,zIndex:t.zIndex+1}});this.videoIsNotEnded=function(){r.tigerUIApi.loadImage(h,o.videoTigerIcons,s.closeBtnWithLine)},this.videoIsEnded=function(){r.tigerUIApi.loadImage(h,o.videoTigerIcons,s.closeBtn).then(function(){r.tigerUIApi.setStyle(h,{width:r.tigerUIApi.scaleSizeInCanvas(50),height:g.height,x:g.x,y:g.y})})},this.videoIsNotEnded()}},{key:"renderSound",value:function(){var e=this,t=this.videoWrapperNode,n=this.tigerVideoConfigs,i=r.tigerUIApi.createNode("videoSoundIcon",{parent:t,style:{x:r.tigerUIApi.scaleSizeInCanvas(110),y:r.tigerUIApi.scaleSizeInCanvas(20),width:r.tigerUIApi.scaleSizeInCanvas(20),height:r.tigerUIApi.scaleSizeInCanvas(16),zIndex:t.zIndex+1}}),a=wx.createInnerAudioContext();a.src=n.audio;var c=!1;this.openSound=function(){if(n.audio){if(!e.isStopVideo){var t=e.nowVideoPlayTimePosition>0?e.nowVideoPlayTimePosition:0;a.seek(t),a.play()}c&&r.tigerUIApi.loadImage(i,o.videoTigerIcons,s.soundBtnOpened)}},this.closeSound=function(){n.audio&&(a.stop(),!c&&r.tigerUIApi.loadImage(i,o.videoTigerIcons,s.soundBtnClose))},this.closeSound(),r.tigerUIApi.bindTap({node:i,type:"touch",callback:function(){c?(c=!1,e.closeSound()):(c=!0,e.openSound())}})}},{key:"renderBanner",value:function(){var e=this,t=this.videoWrapperNode,n=this.tigerVideoConfigs,i=this.winSize,a=r.tigerUIApi.createNode("videoBannerNode",{parent:t,style:{width:i.width-r.tigerUIApi.scaleSizeInCanvas(20),height:r.tigerUIApi.scaleSizeInCanvas(100),x:r.tigerUIApi.scaleSizeInCanvas(10),y:i.height-r.tigerUIApi.scaleSizeInCanvas(20)-r.tigerUIApi.scaleSizeInCanvas(100),zIndex:t.zIndex+1}});r.tigerUIApi.createGraphicsRoundRect(a,{color:"255,255,255",borderRadius:6});var u=r.tigerUIApi.createNode("videoBannerIcon",{parent:t,style:{width:r.tigerUIApi.scaleSizeInCanvas(70),height:r.tigerUIApi.scaleSizeInCanvas(70),x:r.tigerUIApi.scaleSizeInCanvas(30),y:i.height-r.tigerUIApi.scaleSizeInCanvas(20)-r.tigerUIApi.scaleSizeInCanvas(100)+r.tigerUIApi.scaleSizeInCanvas(15),zIndex:t.zIndex+1}});r.tigerUIApi.loadImage(u,n.icon);r.tigerUIApi.createLabelNode("videoBannerTitle",{parent:t,style:{x:r.tigerUIApi.scaleSizeInCanvas(120),y:i.height-r.tigerUIApi.scaleSizeInCanvas(90),width:r.tigerUIApi.scaleSizeInCanvas(100),height:r.tigerUIApi.scaleSizeInCanvas(30),zIndex:t.zIndex+1,fontStyle:{string:n.title,fontSize:r.tigerUIApi.scaleSizeInCanvas(20),overflow:"CLAMP",color:"0,0,0,255"}}}),r.tigerUIApi.createLabelNode("videoBannerContent",{parent:t,style:{x:r.tigerUIApi.scaleSizeInCanvas(120),y:i.height-r.tigerUIApi.scaleSizeInCanvas(60),width:r.tigerUIApi.scaleSizeInCanvas(160),height:r.tigerUIApi.scaleSizeInCanvas(20),zIndex:t.zIndex+1,fontStyle:{string:n.sub_title,fontSize:r.tigerUIApi.scaleSizeInCanvas(12),overflow:"CLAMP",color:"191,191,191,255"}}});var d=r.tigerUIApi.createNode("videoBannerView",{parent:t,style:{x:a.width-r.tigerUIApi.scaleSizeInCanvas(70),y:i.height-r.tigerUIApi.scaleSizeInCanvas(80),width:r.tigerUIApi.scaleSizeInCanvas(60),height:r.tigerUIApi.scaleSizeInCanvas(30),zIndex:t.zIndex+1}});r.tigerUIApi.loadImage(d,o.videoTigerIcons,s.viewBtn),r.tigerUIApi.bindTap({node:a,type:"touch",callback:function(){e.pauseVideo(),e.isShowNavigatorModal=!0,c.default.navigate({tiger_position_id:e.tiger_position_id,creative_id:e.creative_id}).then(function(){e.isShowNavigatorModal=!1,e.continueVideo()}).catch(function(){e.isShowNavigatorModal=!1,e.continueVideo()})}})}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(7),o=c(n(13)),a=c(n(0));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.winSize=r.tigerUIApi.getWinSize(),this.configs=t,this.userPosition={x:0,y:cc.winSize.height-r.tigerUIApi.scaleSizeInCanvas(120)},this.renderWrapperNode(),this.renderBgNode(),this.renderLeftTopTextNode(),this.computedIconWidth(),this.renderScrollArea(),this.renderIconsAndText()}return i(e,[{key:"destroy",value:function(){this.mainNode.destroy()}},{key:"renderWrapperNode",value:function(){var e=r.tigerUIApi.createNode("tigerRecommendNode",{x:0,y:0,width:0,height:0,zIndex:r.DEFAULT_NODE_INDEX+1});this.mainNode=e}},{key:"renderBgNode",value:function(){var e=this.mainNode,t=this.winSize,n=this.userPosition,i=r.tigerUIApi.createNode("recommendBgNode",{parent:e,style:{x:n.x,y:n.y,width:t.width,height:r.tigerUIApi.scaleSizeInCanvas(120),opacity:100,bgColor:"0,0,0",zIndex:e.zIndex+1}});this.bgNode=i}},{key:"renderLeftTopTextNode",value:function(){var e=this.mainNode,t=(this.winSize,this.userPosition);r.tigerUIApi.createLabelNode("recommendTitleNode",{parent:e,style:{width:r.tigerUIApi.scaleSizeInCanvas(80),height:r.tigerUIApi.scaleSizeInCanvas(20),x:t.x+r.tigerUIApi.scaleSizeInCanvas(10),y:t.y+r.tigerUIApi.scaleSizeInCanvas(10),zIndex:e.zIndex+1,fontStyle:{string:"猜你喜欢 >>",fontSize:r.tigerUIApi.scaleSizeInCanvas(12),color:"255,255,255",overflow:"clamp"}}})}},{key:"renderScrollArea",value:function(){this.scrollViewNode&&this.scrollViewNode.destroy();var e=this.mainNode,t=this.winSize,n=this.userPosition,i=this.configs,o=(i.iconWidth,i.iconMarginLeft,i.tigerConfig,r.tigerUIApi.createNode("recommendScrollArea",{parent:e,style:{x:n.x,y:n.y,width:t.width,height:r.tigerUIApi.scaleSizeInCanvas(120),zIndex:e.zIndex+1}})),a=r.tigerUIApi.createNode("iconListWrapperNode",{parent:o,style:{width:t.width,height:r.tigerUIApi.scaleSizeInCanvas(120),x:0,y:0,zIndex:e.zIndex+1}});r.tigerUIApi.setScrollViewNode(o,{content:a,cancelInnerEvents:!1,horizontal:!0,vertical:!1}),this.iconListWrapperNode=a,this.scrollViewNode=o}},{key:"computedIconWidth",value:function(){var e=this.winSize,t=r.tigerUIApi.scaleSizeInCanvas(20),n=e.width/5*(1-t/e.width)-t;this.configs.iconWidth=n,this.configs.iconMarginLeft=t}},{key:"renderIconsAndText",value:function(){var e=this;this.iconAndTextNodes&&(this.iconAndTextNodes.forEach(function(e){var t=e.icon,n=e.iconText;t.destroy(),n.destroy()}),this.iconAndTextNodes=[]);var t=this.configs.tigerConfig,n=this.iconListWrapperNode,i=this.userPosition,o=this.mainNode,a=(this.winSize,this.configs.iconMarginLeft),c=this.configs.iconWidth,u={y:i.y+r.tigerUIApi.scaleSizeInCanvas(35),width:c,height:c,zIndex:o.zIndex+1},s={y:u.y+u.height+r.tigerUIApi.scaleSizeInCanvas(10),height:r.tigerUIApi.scaleSizeInCanvas(20),zIndex:u.zIndex,fontStyle:{fontSize:r.tigerUIApi.scaleSizeInCanvas(10),color:"255,255,255",overflow:"clamp"}};this.iconAndTextNodes=t.list.map(function(t,i){var r=0===i?a:a*(i+1)+c*i;return u.x=r,{icon:e.renderIcon(n,t,u),iconText:e.renderIconText(n,t,s,u)}})}},{key:"renderIcon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t.show_config){var i=r.tigerUIApi.createNode("recommendIconNode"+t.creative_id,{parent:e,style:n});return r.tigerUIApi.setNodeClickScaleTransition(i),r.tigerUIApi.loadImage(i,t.show_config.image),this.bindTapEvent(i,t),i}}},{key:"bindTapEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.tigerUIApi.bindTap({node:e,callback:function(){o.default.navigate({tiger_position_id:n.tiger_position_id,creative_id:n.creative_id}).then(function(e){t.configs.tigerConfig=e[0],t.renderIconsAndText()}).catch(function(e){t.configs.tigerConfig=e[0],t.renderIconsAndText()})}})}},{key:"renderIconText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t.show_config){var o=a.default.cutStringAndBackWidth(t.show_config.title,n.fontStyle.fontSize,5),c=Math.ceil(o.width)+n.fontStyle.fontSize;return n.width=c,n.x=i.x-(c-i.width)/2,n.fontStyle.string=o.string,n.fontStyle.horizontalAlign="CENTER",r.tigerUIApi.createLabelNode("recommendIconTextNode"+t.creative_id,{parent:e,style:n})}}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=l(n(0)),o=l(n(2)),a=n(7),c=l(n(3)),u=l(n(1)),s=n(6),d=l(n(8));function l(e){return e&&e.__esModule?e:{default:e}}var f=Symbol("globalConfig"),g=Symbol("renderNode"),h=Symbol("bindTapEvent"),p=Symbol("navigate"),v=Symbol("checkIsRenderNode"),y=Symbol("getGameInfo"),_=Symbol("_destroy"),I="https://cdn.kuaiyugo.com/plat/SDK/sdk_img_res/icon_arrow_left.png";t.default=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this[f]={},this.referrerInfo={},this.checkJumpablePromise=null}return i(e,[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:999999999;return console.log("[BackBtn] create，",e,n,i),this[f]=Object.assign(this[f],{x:e,y:n,zIndex:i}),this.checkJumpablePromise||(this.checkJumpablePromise=this[v]()),this.checkJumpablePromise.then(function(){t[f].isCreated?t[_]():t[f].isCreated=!0,t[g](),t[h]()}).catch(function(e){console.error(e)}),this}},{key:v,value:function(){var e=this;return new Promise(function(t,n){var i=e.referrerInfo;if(console.log("从A端游戏跳至B端游戏 this.referrerInfo: ",i),i.appId){var r=i.appId||"",o=s.SDK_CONFIG.APPID;e[y](r,o).then(function(i){i.is_backed_flow?(e[f].program_name=i.program_name,t()):n("A端不在B端的可跳转列表中")})}else n("从A端游戏跳至B端游戏,缺少appid")})}},{key:y,value:function(e,t){return o.default.getBackBtnGameInfo({A_app_id:e,B_app_id:t}).then(function(e){return{program_name:e.program_name||"",is_backed_flow:e.is_backed_flow||!1}}).catch(function(e){return console.error("请求错误: "+(e?JSON.stringify(e):"")),{program_name:"",is_backed_flow:!1}})}},{key:g,value:function(){var e=this[f],t=this[f].program_name||"返回",n=r.default.cutStringAndBackWidth(t,15);t=n.string;var i=n.width+30,o=a.tigerUIApi.createNode("back_btn",{style:{zIndex:e.zIndex}}),c=a.tigerUIApi.createLabelNode("back_btn_label",{parent:o,style:{width:a.tigerUIApi.scaleSizeInCanvas(i),height:a.tigerUIApi.scaleSizeInCanvas(25),x:a.tigerUIApi.scaleSizeInCanvas(e.x+2),y:a.tigerUIApi.scaleSizeInCanvas(e.y),zIndex:e.zIndex+2,fontStyle:{string:t,fontSize:a.tigerUIApi.scaleSizeInCanvas(15),lineHeight:a.tigerUIApi.scaleSizeInCanvas(25),horizontalAlign:"CENTER",verticalAlign:"CENTER",color:"255,255,255,255"}}}),u=a.tigerUIApi.createNode("back_btn_bg",{parent:o,style:{width:a.tigerUIApi.scaleSizeInCanvas(i),height:a.tigerUIApi.scaleSizeInCanvas(25),x:a.tigerUIApi.scaleSizeInCanvas(e.x),y:a.tigerUIApi.scaleSizeInCanvas(e.y),zIndex:e.zIndex+1}});a.tigerUIApi.createGraphicsRoundRect(u,{color:"0,0,0,100",borderRadius:a.tigerUIApi.scaleSizeInCanvas(12)});var s=a.tigerUIApi.createNode("back_btn_icon",{parent:o,style:{width:a.tigerUIApi.scaleSizeInCanvas(10),height:a.tigerUIApi.scaleSizeInCanvas(10),x:a.tigerUIApi.scaleSizeInCanvas(e.x+5),y:a.tigerUIApi.scaleSizeInCanvas(e.y+8),zIndex:e.zIndex+2}});a.tigerUIApi.loadImage(s,I),this[f].backBtnNode=o,this[f].backBtnLabelNode=c,this[f].backBtnBgNode=u}},{key:h,value:function(){var e=this,t=this[f].backBtnLabelNode;t&&a.tigerUIApi.bindTap({type:"touch",node:t,callback:function(){e[p]()}})}},{key:p,value:function(){var e=this.referrerInfo,t=e.appId;if(t){var n=c.default.getStatisticSDK(),i=n.packLogData().userLog.ext;i.v=s.SDK_CONFIG.SDKVERSION,i.fromType="backBtn";var o=[];e&&e.extraData&&e.extraData.tiger_list&&(o=e.extraData.tiger_list),n.sendTigerBehaviourBackButtonSync("backClick",{list:o}),d.default.fetchUserInfo({openIdOnly:!0}).then(function(){wx.navigateToMiniProgram({appId:t,path:r.default.addQuery("pages/index/index"),extraData:{tiger_info:i,tiger_list:o,mergeAccount:{appId:s.SDK_CONFIG.APPID,openId:u.default.get("xhstat_uuid")}},envVersion:"release",success:function(){n.sendTigerBehaviourBackButtonSync("backConfirm",{list:o})},fail:function(e){e&&e.errMsg&&e.errMsg.indexOf("cancel")>-1||console.error("跳转失败，请检查game.json(小游戏)/app.json(小程序)跳转列表是否配置正确")}})})}else console.error("请传入正确的appId",e)}},{key:_,value:function(){var e=this[f],t=e.backBtnNode,n=e.backBtnLabelNode,i=e.backBtnBgNode;n&&!a.tigerUIApi.isDestroy(n)&&n.destroy(),i&&!a.tigerUIApi.isDestroy(i)&&i.destroy(),t&&!a.tigerUIApi.isDestroy(t)&&t.destroy()}},{key:"destroy",value:function(){this[_](),this[f].isCreated=!1,this.checkJumpablePromise=null}},{key:"sendBackLogFromA",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.scene=e.scene&&Number(e.scene),e.scene&&-1!==[1037,1038].indexOf(e.scene)){e.query;var t=r.default.deepClone(e.referrerInfo);if(t){this.referrerInfo=t;var n=t.extraData||{},i=n.tiger_info||{},o=n.tiger_list||[];"backBtn"===i.fromType&&d.default.fetchUserInfo({openIdOnly:!0}).then(function(){XH_STATISTIC.sendTigerBehaviourBackButtonSync("backLogin",{list:o,ak:i.ak,aid:i.aid,tid:i.tid,uid:i.uid,pid:i.pid,uidfp:i.uidfp,uid2:u.default.get("xhstat_uuid")})})}}}}]),e}())}]);